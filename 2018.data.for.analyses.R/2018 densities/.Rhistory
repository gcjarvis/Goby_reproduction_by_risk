axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0,18),breaks = c(4,8,12,16)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30)))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20))+
scale_x_continuous(breaks=c(5, 10, 15, 20,25,30)))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
png(filename = "Output/2019.10.24.den.manuscript.means.png", width = 900, height = 600)
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
dev.off()
png(filename = "Output/2019.10.24.den.manuscript.means.png", width = 1000, height = 500)
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
dev.off()
den<-with(viz.surv, aggregate((den.max), list(Day=Day,Treatment=Treatment), mean))
den$se<-with(viz.surv, aggregate((den.max), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
png(filename = "Output/2019.10.24.den.max.MS.means.png", width = 1000, height = 500)
den.plot <- ggplot(den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot
dev.off()
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 densities/Scripts/2019.10.1.reananalyzing.den.R')
#no grouping factor
bargraph.CI(x.factor = Treatment, response = Egg.count,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = viz.surv)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = Density,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = viz.surv)
gob.den<-read.csv("Data/density.2019.4.26.csv")
#subsetting by trial
den.2017<-gob.den[(gob.den$Trial<4), ]
den.2018.t4.5<-gob.den[(gob.den$Trial>3) & (gob.den$Trial<6), ]
den.2018.t6<-gob.den[(gob.den$Trial>5), ]
den.2017$Treatment<-ordered(den.2017$Treatment,levels=c("Low","Medium","High"))
viz.sur.2017<-with(den.2017, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
viz.sur.2017$se<-with(den.2017, aggregate((Density), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
p <- ggplot(viz.sur.2017, aes(x=Day, y=x, group=Treatment, color=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_line(size=1.5)+
geom_line(aes(linetype=Treatment)) +
geom_point(aes(shape=Treatment))+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 34, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 20, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0,18),breaks = c(4,8,12,16)) + scale_x_continuous(breaks=c(1,2,3,4,5,6))+
theme(text = element_text(family="Arial"))
p + scale_color_manual(values=c("#0072B2","#009E73","#D55E00")) + theme(legend.text=element_text(size=20)) + theme(legend.title =element_text(size=28, face="bold"))
#models, comparing density vs. den.max
#density
mod.1a<-glmer(Density ~ Treatment * Day + (1|Trial),family = poisson, data=viz.surv)
hist(resid(mod.1a))
qqnorm(resid(mod.1a))
qqline(resid(mod.1a))
anova(mod.1a)
Anova(mod.1a)
#loading data
viz.surv<-read.csv("Data/density.2019.10.1.csv", na.strings = "")
viz.surv$Density<-as.numeric(viz.surv$Density)
viz.surv$den.max<-as.numeric(viz.surv$den.max)
#den.max
mod.1<-glmer(den.max ~ Treatment * Day + (1|Trial),family=poisson, data=viz.surv)
hist(resid(mod.1))
qqnorm(resid(mod.1)) #not really normal, maybe there's a better transformation
qqline(resid(mod.1))
anova(mod.1)
Anova(mod.1)
summary(mod.1)
#models, comparing density vs. den.max
#trying linear model, no poisson distribution
mod.a<-(Density~Treatment*Day+(1|Trial), data=viz.surv)
#models, comparing density vs. den.max
#trying linear model, no poisson distribution
mod.a<-lmer(Density~Treatment*Day+(1|Trial), data=viz.surv)
hist(mod.a)
hist(resid(mod.a))
qqnorm(resid(mod.a))
qqline(resid(mod.a))
anova(mod.a)
Anova(mod.a)
mod.b<-lmer(den.max~Treatment*Day+(1|Trial),data=viz.surv)
hist(resid(mod.b))
qqnorm(resid(mod.b))
qqline(resid(mod.b))
anova(mod.b)
Anova(mod.b)
anova(mod.b)
#den.max
mod.1<-glmer(den.max ~ Treatment * Day + (1|Trial),family=poisson, data=viz.surv)
hist(resid(mod.1))
qqnorm(resid(mod.1)) #not really normal, maybe there's a better transformation
qqline(resid(mod.1))
anova(mod.1)
Anova(mod.1)
gob.den<-read.csv("Data/density.2019.4.26.csv", na.strings = "")
gob.den$Treatment<-ordered(gob.den$Treatment,levels=c("Low","Medium","High","Uncaged"))
retry<-with(gob.den, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
warnings()
gob.den$Density<-as.numeric(gob.den$Density)
retry<-with(gob.den, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
retry$se<-with(gob.den, aggregate((Density), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den.plot.2 <- ggplot(retry, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey","grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash", "dashed"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot.2
retry
gob.den
gob.den<-read.csv("Data/density.2019.4.26.csv", na.strings = "")
gob.den$Treatment<-ordered(gob.den$Treatment,levels=c("Low","Medium","High","Control"))
gob.den$Density<-as.numeric(gob.den$Density)
retry<-with(gob.den, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
retry$se<-with(gob.den, aggregate((Density), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
retry
den.plot.2 <- ggplot(retry, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey","grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash", "dashed"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot.2
gob.den$den.max<-as.numeric(gob.den$den.max)
retry<-with(gob.den, aggregate((den.max), list(Day=Day,Treatment=Treatment), mean))
retry$se<-with(gob.den, aggregate((den.max), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
retry
den.plot.2 <- ggplot(retry, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey","grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash", "dashed"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot.2
new.t4.5<-gob.den[(gob.den$Trial>3) & (gob.den$Trial<6), ]
retry.t4.5<-with(new.t4.5, aggregate((den.max), list(Day=Day,Treatment=Treatment), mean))
retry.t4.5$se<-with(new.t4.5, aggregate((den.max), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den.plot.3 <- ggplot(retry.t4.5, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot.3
den.t4.5<-gob.den[(gob.den$Trial>3) & (gob.den$Trial<6), ]
retry.t4.5.den<-with(den.t4.5, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
retry.t4.5.den$se<-with(new.t4.5, aggregate((Density), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den.plot.4 <- ggplot(retry.t4.5.den, aes(x=Day, y=x, shape=Treatment, color=Treatment, linetype=Treatment))+
geom_linerange(aes(ymin=x-se, ymax=x+se),
position=position_dodge(0)) +
geom_point(size=3)+
labs(x="Day", y = "Number of Fish Seen")+
theme_classic() +
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
geom_line(aes(linetype=Treatment))+
geom_line(size=1.0)+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_y_continuous(expand = c(0, 0),limits = c(0,21),breaks = c(5,10,15,20)) + scale_x_continuous(breaks=c(5, 10, 15, 20,25,30))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
den.plot.4
retry.t4.5
#average density per treatment, making df for ggplot
viz.surv$Treatment<-ordered(viz.surv$Treatment,levels=c("Low","Medium","High"))
den<-with(viz.surv, aggregate((Density), list(Day=Day,Treatment=Treatment), mean))
den$se<-with(viz.surv, aggregate((Density), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den
#average density per treatment
viz.surv$Treatment<-ordered(viz.surv$Treatment,levels=c("Low","Medium","High"))
den<-with(viz.surv, aggregate((den.max), list(Day=Day,Treatment=Treatment), mean))
den$se<-with(viz.surv, aggregate((den.max), list(Day=Day,Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,3]
den
header
rm(list=ls())
#loading libraries
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
#loading data
viz.surv<-read.csv("Data/density.2019.10.1.csv", na.strings = "")
viz.surv$Density<-as.integer(viz.surv$Density)
viz.surv$den.max<-as.integer(viz.surv$den.max)
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Week", ylab="Fish density per reef", data=viz.surv)
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
View(viz.surv)
viz.surv$Day<-as.factor(viz.surv$Day)
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
den<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment,Day=Day), mean))
den$se<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment,Day=Day),
function(x) sd(x)/sqrt(length(x))))[,3]
den
den<-with(viz.surv, aggregate((den.max), list(Day=Day), mean))
den
den<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment), mean))
den
View(presidents)
tapply(presidents, cycle(presidents), mean, na.rm = TRUE)
tapply(viz.surv, (den.max), list(Treatment=Treatment), mean, na.rm=TRUE)
tapply(viz.surv, den.max, mean, na.rm=TRUE)
tapply(den.max, Treatment, mean, na.rm=TRUE, data=viz.surv)
tapply(viz.surv$den.max, list(viz.surv$Treatment,viz.surv$Day), mean, na.rm=TRUE)
tapply(viz.surv$den.max, viz.surv$Day, mean, na.rm=TRUE)
#loading data
viz.surv<-read.csv("Data/density.2019.10.25.csv", na.strings = "")
viz.surv$Density<-as.integer(viz.surv$Density)
viz.surv$den.max<-as.integer(viz.surv$den.max)
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
View(viz.surv)
#loading data
viz.surv<-read.csv("Data/density.2019.10.25.csv")
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
den<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment), mean))
den$se<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment,Day=Day),
function(x) sd(x)/sqrt(length(x))))[,3]
den<-with(viz.surv, aggregate((den.max), list(Day=Day,Treatment=Treatment), mean))
den$se<-with(viz.surv, aggregate((den.max), list(Treatment=Treatment,Day=Day),
function(x) sd(x)/sqrt(length(x))))[,3]
den
#loading data, make sure not to do na.rm = ""...MY GOD!!!
#that was the issue
viz.surv<-read.csv("Data/density.2019.10.25.csv")
viz.surv$den.max<-as.integer(viz.surv$den.max)
viz.surv$Day<-as.factor(viz.surv$Day)
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
viz.surv$Treatment<-ordered(viz.surv$Treatment,levels=c("Low","Medium","High"))
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
viz.surv$Treatment<-ordered(viz.surv$Treatment,levels=c("Low","Medium","High"))
#quick plot
lineplot.CI(Day,den.max,group=Treatment,legend = TRUE,main="all trials", xlab="Day", ylab="Fish density per reef", data=viz.surv)
mod.b<-lmer(den.max~Treatment*Day+(1|Trial),data=viz.surv)#probably go with this model
hist(resid(mod.b))
qqnorm(resid(mod.b))
qqline(resid(mod.b))
anova(mod.b) #sig. interaction, everything significant
Anova(mod.b)
#no grouping factor, seems like H>L=M, strange...with den.max
#goes against what Mark found...
bargraph.CI(x.factor = Treatment, response = den.max,
legend=TRUE, main="den.max, HR combined grouped by trial",
data = viz.surv)
bargraph.CI(x.factor = Day, response = den.max,
group= Treatment, legend=TRUE, main="all trials, HR combined grouped by trial",
data = viz.surv)
