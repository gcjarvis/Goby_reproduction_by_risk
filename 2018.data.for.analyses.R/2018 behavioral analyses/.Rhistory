axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.51),
labels = scales::number_format(accuracy = 0.01)) #changed to 2 decimal places for movement rate)
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
reco.plot<- ggplot(mm, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment", y= expression(c('Movement Rate',
'(movements min '^-1*')')))+
#expression('Frequency
#(364 days)' ^ -1))+
#         (expression("Movement Rate",
#                                                paste((movements~min^-1))))))
#"Survival
#  (gobies recollected per reef)") +
#labs(x="Risk Treatment",y=(expression(atop("Movement Rate",
#                                            paste((movements~min^-1))))))+
#labs(x="Risk Treatment",y=((expression("Movement Rate",
#       paste('(movements min '^-1*')')))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.51),
labels = scales::number_format(accuracy = 0.01)) #changed to 2 decimal places for movement rate)
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#library
library(ggplot2)
#loading data
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
behave$avg.inhab<-(ceiling((behave$Recollection+20)/2))
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
png("Output/2019.11.14.bite.rate.with.parentheses.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(fr, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Foraging",
paste((bites~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.01))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
dev.off()
#library
library(ggplot2)
#foraging (bites per minute)####
fr<-with(behave, aggregate((bites.min), list(Treatment=Treatment), mean))
fr$se<-with(behave, aggregate((bites.min), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png("Output/2019.11.14.bite.rate.with.parentheses.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(fr, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Foraging",
paste((bites~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.01))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
dev.off()
#courtship rate (displays per minute)####
cr<-with(behave, aggregate((courtship.min), list(Treatment=Treatment), mean))
cr$se<-with(behave, aggregate((courtship.min), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png("Output/2019.11.14.courtship.rate.with.parentheses.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(cr, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Courtship",
paste((displays~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.151))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
dev.off()
reco.plot<- ggplot(mm, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Movements min"^-1))))+
#                                         paste((movements~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.51),
labels = scales::number_format(accuracy = 0.01)) #changed to 2 decimal places for movement rate)
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#movement rate (movements per minute), includes code for superscript####
mm<-with(behave, aggregate((movements.min), list(Treatment=Treatment), mean))
mm$se<-with(behave, aggregate((movements.min), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
reco.plot<- ggplot(mm, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Movements min"^-1))))+
#                                         paste((movements~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.51),
labels = scales::number_format(accuracy = 0.01)) #changed to 2 decimal places for movement rate)
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
png("Output/2019.11.14.movement.swims.with.rate.parentheses.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(mm, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Movements min"^-1))))+
#                                         paste((movements~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,1.51),
labels = scales::number_format(accuracy = 0.01)) #changed to 2 decimal places for movement rate)
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
dev.off()
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
#library(psych)#descriptive statistics
#library(effects)#adjusted means
#easiest mancova package
#library(jmv)
library(agricolae)#can't use standard tukey test for mixed models
library(multcomp)# post-hoc for fixed effects in mixed model
# 1) proportion of time exposed, sig. effect, ran post-hoc test for mult comp: L(a),M(ab),H(b)####
# without density in model
#trial different outcome if coded as a factor??? NO
mod.ex<-lmer(proportion.exposed~ Treatment + (1|Trial), data=behave)
hist(resid(mod.ex))
qqnorm(resid(mod.ex))
qqline(resid(mod.ex))
anova(mod.ex) # sig. effect
Anova(mod.ex) #sig.effect
ranova(mod.ex)
#loading df####
behave<-read.csv("Data/2019.10.8.behavior.ss.csv")
#clear workspace
rm(list=ls())
#loading packages####
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
#library(psych)#descriptive statistics
#library(effects)#adjusted means
#easiest mancova package
#library(jmv)
library(agricolae)#can't use standard tukey test for mixed models
#loading df####
behave<-read.csv("Data/2019.10.8.behavior.ss.csv")
behave<-na.omit(behave) #no NA's to remove
#with recollection data
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
#clear workspace
rm(list=ls())
#loading df####
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
# NOTE: there were no behavioral observations for trial 6
behave$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
# NOTE: there were no behavioral observations for trial 6
behave$Year <- ifelse(behave$Trial <=3, 2017, 2018)
#Going to make a variable with it as a factor, though I don't think it matters a whole lot
behave$Year.fact<- as.factor(behave$Year)
#making the variable "avg.inhab" ((20+reco)/2), rounded to the nearest whole fish
behave$avg.inhab<-(ceiling((behave$Recollection+20)/2))
#proportion of time exposed####
pe1<-lmer(proportion.exposed~Treatemnt*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
#proportion of time exposed####
pe1<-lmer(proportion.exposed~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(pe1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1))
qqline(resid(pe1))
anova(pe1)#type III anova = no treatment effect, no interactive effect
Anova(pe1)#Analysis of deviance, type II wald test = sig. trt. effect,
anova(pe1)#type III anova = no treatment effect, no interactive effect
Anova(pe1)#Analysis of deviance, type II wald test = sig. trt. effect,
#                                                     no density, no interactive
summary(pe1)
#plotting
#ordering "Treatment" and "T.6.comparison"
behave$Treatment.ord<-ordered(behave$Treatment, levels=c("Low","Medium","High"))
#grouped by trial
bargraph.CI(x.factor = Treatment.ord, response = proportion.exposed,
group= Trial, legend=TRUE, main="proportion of time exposed, grouped by trial",
data = behave)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = proportion.exposed,
group= Year, legend=TRUE, main="proportion of time exposed, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = proportion.exposed,
legend=TRUE, main="proportion of time exposed, grouped by trial",
data = behave)
#posthoc test
summary(glht(pe1, linfct=mcp(Treatment="Tukey")))
library(multcomp)# post-hoc for fixed effects in mixed model
#posthoc test
summary(glht(pe1, linfct=mcp(Treatment="Tukey")))
#reducing the model, removing nonsignificant interactions with covariate
pe1.1<-lmer(proportion.exposed~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
#reducing the model, removing nonsignificant interactions with covariate
pe1.1<-lmer(proportion.exposed~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(pe1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.1))
qqline(resid(pe1.1))
anova(pe1.1)#type III anova = no treatment effect, no interactive effect
Anova(pe1.1)#Analysis of deviance, type II wald test = sig. trt. effect,
summary(glht(pe1.1, linfct=mcp(Treatment="Tukey")))
#reducing further, removing the NS interactions with covariate
pe1.2<-lmer(proportion.exposed~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(pe1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.2))
qqline(resid(pe1.2))
anova(pe1.2)#type III anova = no treatment effect, no interactive effect
Anova(pe1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = proportion.exposed,
legend=TRUE, main="proportion of time exposed",
data = behave)
summary(glht(pe1.2, linfct=mcp(Treatment="Tukey")))
#movements/minute####
mm1<-lmer(movements.min~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(mm1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1))
qqline(resid(mm1))
anova(mm1)#type III anova = no treatment effect, no interactive effects
Anova(mm1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing the model, removing nonsignificant interactions with covariate
mm1.1<-lmer(movements.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(mm1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.1))
qqline(resid(mm1.1))
anova(mm1.1)#type III anova = no treatment effect, no interactive effect
Anova(mm1.1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing further, removing the NS interactions with covariate
mm1.2<-lmer(movements.min~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(mm1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.2))
qqline(resid(mm1.2))
anova(mm1.2)#type III anova = sig. treatment effect with ANOVA (III)
Anova(mm1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
#                                                     no density, no interactive
summary(mm1.2)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = movements.min,
legend=TRUE, main="movements per minute",
data = behave)
#grouped by trial
bargraph.CI(x.factor = Treatment.ord, response = movements.min,
group= Trial, legend=TRUE, main="movements.min, grouped by trial",
data = behave)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = proportion.exposed,
group= Year, legend=TRUE, main="movements.min, grouped by year",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = movements.min,
legend=TRUE, main="movements per minute",
data = behave)
anova(mm1.2)#type III anova = sig. treatment effect with ANOVA (III)
Anova(mm1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
#bites/min (feeding rate)####
bm1<-lmer(bites.min~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(bm1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(bm1))
qqline(resid(bm1))
anova(bm1)#type III anova = no treatment effect, no interactive effects
Anova(bm1)#Analysis of deviance, type II wald test = NS trt. effect,
#reducing the model, removing the NS three-way interaction
#unlike the two previous models, I'm going to keep in the avg.inhab*year term
br1.1<-lmer(bites.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(br1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.1))
qqline(resid(br1.1))
anova(br1.1)#type III anova = no treatment effect, no interactive effect
Anova(br1.1)#Analysis of deviance, type II wald test = NS trt. effect,
#reducing further, removing the NS interactions with covariate (-treatment*avg.inhab)
br1.2<-lmer(movements.min~Treatment+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(br1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.2))
qqline(resid(br1.2))
anova(br1.2)#type III anova = sig. treatment effect with ANOVA (III)
#reducing further, removing the NS interactions with covariate (-treatment*avg.inhab)
br1.2<-lmer(bites.min~Treatment+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(br1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.2))
qqline(resid(br1.2))
anova(br1.2)#type III anova = sig. treatment effect with ANOVA (III)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
legend=TRUE, main="bites per minute",
data = behave)
#grouped by trial
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
group= Trial, legend=TRUE, main="bites per min, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
legend=TRUE, main="bites per minute",
data = behave)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
group= Year, legend=TRUE, main="movements.min, grouped by year",
data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = average.inhab, response = bites.min,
group= Year.fact, legend=TRUE, main="bites per min, by inhab and year",
data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = bites.min,
group= Year.fact, legend=TRUE, main="bites per min, by inhab and year",
data = behave)
#reducing further, removing the NS interactions with covariate (-treatment*avg.inhab)
br1.2<-lmer(bites.min~Treatment+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(br1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.2))
qqline(resid(br1.2))
anova(br1.2)#type III anova = sig. treatment effect with ANOVA (III)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
group= Year, legend=TRUE, main="movements.min, grouped by year",
data = behave)
#just looking at bite rates by year
bargraph.CI(x.factor = Year.fact, response = bites.min,
legend=TRUE, main="bites per minute, by year only",
data = behave)
Anova(br1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
anova(br1.2)#type III anova = sig. treatment effect with ANOVA (III)
Anova(br1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = bites.min,
legend=TRUE, main="bites per minute",
data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = bites.min,
group= Year.fact, legend=TRUE, main="bites per min, by inhab and year",
xlab= "avg.ihab",data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = bites.min,
group= Year.fact, legend=TRUE, main="bites per min, by inhab and year",
xlab= "avg.inhab",data = behave)
#total distance moved####
dm1<-lmer(total.dist.moved~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1))
qqline(resid(dm1))
anova(dm1)#type III anova = no treatment effect, no interactive effects
Anova(dm1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing the model, removing nonsignificant interactions with covariate
dm1.1<-lmer(total.dist.moved~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.1))
qqline(resid(dm1.1))
anova(dm1.1)#type III anova = no treatment effect, no interactive effect
Anova(dm1.1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing further, removing the NS interactions with covariate
dm1.2<-lmer(total.dist.moved~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.2))
qqline(resid(dm1.2))
anova(dm1.2)#type III anova = sig. treatment effect with ANOVA (III)
Anova(dm1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
anova(dm1.2)#type III anova = sig. treatment effect with ANOVA (III)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
legend=TRUE, main="total distance moved",
data = behave)
#grouped by trial
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
group= Trial, legend=TRUE, main="total.dist.moved, grouped by trial",
data = behave)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
group= Year, legend=TRUE, main="total.dist.moved, grouped by year",
data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = total.dist.moved,
group= Year.fact, legend=TRUE, main="distance moved, by inhab and year",
xlab= "avg.inhab",data = behave)
anova(dm1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(dm1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
#courtship rate####
cr1<-lmer(courtship.min~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1))
qqline(resid(cr1))
anova(cr1)#type III anova = sig. avg.inhab, all else NS, no 3-way int.
Anova(cr1)#Chi square (same as above) = sig. avg inhab, no 3-way int (p = 0.084)
#reducing the model, removing nonsignificant interactions with covariate
cr1.1<-lmer(courtship.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.1))#looks like a slightly better model in terms of assumptions
#reducing the model, removing nonsignificant interactions with covariate
cr1.1<-lmer(courtship.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.1))
qqline(resid(cr1.1))
anova(cr1.1)#type III anova = sig. avg.inhab, all else NS
Anova(cr1.1)#Chi square (same as above) = sig. avg inhab, all else NS
#reducing further, removing the NS interactions with covariate
cr1.2<-lmer(courtship.min~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
#reducing further, removing the NS interactions with covariate
cr1.2<-lmer(courtship.min~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.2))
qqline(resid(cr1.2))
anova(cr1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(cr1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
# I suppose I'd be more comfortable with the Chi square result, based on the previous models
summary(cr1.2)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = courtship.min,
legend=TRUE, main="courtship by treatment",
data = behave)
anova(cr1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(cr1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
