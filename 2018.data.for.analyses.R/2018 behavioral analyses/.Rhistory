qqline(resid(dm1))
anova(dm1)#type III anova = no treatment effect, no interactive effects
Anova(dm1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing the model, removing nonsignificant interactions with covariate
dm1.1<-lmer(total.dist.moved~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.1))
qqline(resid(dm1.1))
anova(dm1.1)#type III anova = no treatment effect, no interactive effect
Anova(dm1.1)#Analysis of deviance, type II wald test = sig. trt. effect,
#reducing further, removing the NS interactions with covariate
dm1.2<-lmer(total.dist.moved~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.2))
qqline(resid(dm1.2))
anova(dm1.2)#type III anova = sig. treatment effect with ANOVA (III)
Anova(dm1.2)#Analysis of deviance, type II wald test = sig. trt. effect,
anova(dm1.2)#type III anova = sig. treatment effect with ANOVA (III)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
legend=TRUE, main="total distance moved",
data = behave)
#grouped by trial
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
group= Trial, legend=TRUE, main="total.dist.moved, grouped by trial",
data = behave)
#grouped by year
bargraph.CI(x.factor = Treatment.ord, response = total.dist.moved,
group= Year, legend=TRUE, main="total.dist.moved, grouped by year",
data = behave)
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = total.dist.moved,
group= Year.fact, legend=TRUE, main="distance moved, by inhab and year",
xlab= "avg.inhab",data = behave)
anova(dm1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(dm1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
#courtship rate####
cr1<-lmer(courtship.min~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1))
qqline(resid(cr1))
anova(cr1)#type III anova = sig. avg.inhab, all else NS, no 3-way int.
Anova(cr1)#Chi square (same as above) = sig. avg inhab, no 3-way int (p = 0.084)
#reducing the model, removing nonsignificant interactions with covariate
cr1.1<-lmer(courtship.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(dm1.1))#looks like a slightly better model in terms of assumptions
#reducing the model, removing nonsignificant interactions with covariate
cr1.1<-lmer(courtship.min~(Treatment*avg.inhab)+(Treatment*Year.fact)+(avg.inhab*Year.fact)+
Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.1))
qqline(resid(cr1.1))
anova(cr1.1)#type III anova = sig. avg.inhab, all else NS
Anova(cr1.1)#Chi square (same as above) = sig. avg inhab, all else NS
#reducing further, removing the NS interactions with covariate
cr1.2<-lmer(courtship.min~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
#reducing further, removing the NS interactions with covariate
cr1.2<-lmer(courtship.min~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
hist(resid(cr1.2))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.2))
qqline(resid(cr1.2))
anova(cr1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(cr1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
# I suppose I'd be more comfortable with the Chi square result, based on the previous models
summary(cr1.2)
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = courtship.min,
legend=TRUE, main="courtship by treatment",
data = behave)
anova(cr1.2)#type III anova = sig. inhab effect, nearly a treatment effect (p = 0.058)
Anova(cr1.2)#Chi square (same as above) = sig. avg inhab, no sig. trt. effect (p = 0.083)
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
#library(psych)#descriptive statistics
#library(effects)#adjusted means
#easiest mancova package
#library(jmv)
library(agricolae)#can't use standard tukey test for mixed models
library(multcomp)# post-hoc for fixed effects in mixed model
library(nlme)
library(lsmeans)#for running LS adjusted means for comparisons
#loading df####
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
# NOTE: there were no behavioral observations for trial 6
behave$Year <- ifelse(behave$Trial <=3, 2017, 2018)
#Going to make a variable with it as a factor, though I don't think it matters a whole lot
behave$Year.fact<- as.factor(behave$Year)
#making the variable "avg.inhab" ((20+reco)/2), rounded to the nearest whole fish
#using the average number of inhabitants per reef as the covariate
behave$avg.inhab<-(ceiling((behave$Recollection+20)/2))
#incorporating new nlme model
pe1.3<-nlme(proportion.exposed~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=behave)
#incorporating new nlme model
pe1.3<-nlme(proportion.exposed~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact,random=~1|Trial, behave, method = "REML")
#incorporating new nlme model
pe1.3<-lme(proportion.exposed~Treatment+(Treatment*Year.fact)+
avg.inhab+Year.fact,random=~1|Trial, behave, method = "REML")
hist(resid(pe1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.3))
qqline(resid(pe1.3))
anova(pe1.3)#type III anova = sig. treatment effect with ANOVA (III)
#now doing contrasts by treatment
lsmeans(pe1.3,
pairwise~Treatment,
adjust="tukey")
#running full model to make sure the reduced morel is correct
pe1.3.0<-lme(proportion.exposed~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(pe1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.3.0))
qqline(resid(pe1.3.0))
anova(pe1.3.0)
anova(pe1.3)#type III anova = sig. treatment effect with ANOVA (III)
pe1.3.1<-lme(proportion.exposed~Treatment*Year.fact,
random=~1|Trial, behave, method = "REML")
hist(resid(pe1.3.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.3.1))
qqline(resid(pe1.3.1))
anova(pe1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
#arithmetic means
library(FSA)
Summarize(egg.week~Treatment,
data=repro,
digits=3)
Summarize(proportion.exposed~Treatment,
data=behave,
digits=3)
#LS-adjusted means
lsmeans(pe1.3,
pairwise~Treatment,
adjust="tukey")
#running full model to make sure the reduced morel is correct
mm1.3.0<-lme(movements.min~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(mm1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.3.0))
qqline(resid(mm1.3.0))
anova(mm1.3.0)
mm1.3<-lme(proportion.exposed~Treatment+(Treatment*Year.fact)+
Year.fact,random=~1|Trial, behave, method = "REML")
hist(resid(mm1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.3))
qqline(resid(mm1.3))
anova(mm1.3)#type III anova = sig. treatment effect with ANOVA (III)
mm1.3<-lme(movements.min~Treatment+(Treatment*Year.fact)+
Year.fact,random=~1|Trial, behave, method = "REML")
hist(resid(mm1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.3))
qqline(resid(mm1.3))
anova(mm1.3)#type III anova = sig. treatment effect with ANOVA (III)
mm1.3.1<-lme(movements.min~Treatment*Year.fact,
random=~1|Trial, behave, method = "REML")
hist(resid(mm1.3.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mm1.3.1))
qqline(resid(mm1.3.1))
anova(mm1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
#plotting
#ordering "Treatment" and "T.6.comparison"
behave$Treatment.ord<-ordered(behave$Treatment, levels=c("Low","Medium","High"))
#no grouping factor
bargraph.CI(x.factor = Treatment.ord, response = movements.min,
legend=TRUE, main="movements per minute",
data = behave)
#LS-adjusted means
lsmeans(mm1.3,
pairwise~Treatment,
adjust="tukey")
#LS-adjusted means
lsmeans(pe1.3.1,
pairwise~Treatment,
adjust="tukey")
Summarize(proportion.exposed~Treatment,
data=behave,
digits=3)
Summarize(proportion.exposed~Treatment,
data=behave,
digits=3)
#LS-adjusted means
lsmeans(pe1.3.1,
pairwise~Treatment,
adjust="tukey")
Summarize(proportion.exposed~Treatment,
data=behave,
digits=3)
Summarize(movements.min~Treatment,
data=behave,
digits=3)
anova(mm1.3.0)
anova(mm1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#running full model to make sure the reduced morel is correct
br1.3.0<-lme(bites.min~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(pe1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.3.0))
qqline(resid(pe1.3.0))
#running full model to make sure the reduced morel is correct
br1.3.0<-lme(bites.min~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(br1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.3.0))
qqline(resid(br1.3.0))
anova(br1.3.0)
#running full model to make sure the reduced morel is correct
pe1.3.0<-lme(proportion.exposed~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(pe1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(pe1.3.0))
qqline(resid(pe1.3.0))
anova(pe1.3.0)
br1.3.1<-lme(proportion.exposed~Treatment*Year.fact,
random=~1|Trial, behave, method = "REML")
hist(resid(br1.3.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(br1.3.1))
qqline(resid(br1.3.1))
anova(br1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
Summarize(bites.min~Treatment,
data=behave,
digits=3)
#LS-adjusted means
lsmeans(br1.3.1,
pairwise~Treatment,
adjust="tukey")
#running full model to make sure the reduced morel is correct
dm1.3.0<-lme(total.dist.moved~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(dm1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.3.0))
qqline(resid(dm1.3.0))
anova(dm1.3.0)
dm1.3<-lme(total.dist.moved~Treatment+(Treatment*Year.fact)+
Year.fact+avg.inhab,random=~1|Trial, behave, method = "REML")
hist(resid(dm1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.3))
qqline(resid(dm1.3))
anova(dm1.3)#type III anova = sig. treatment effect with ANOVA (III)
Summarize(total.dist.moved~Treatment,
data=behave,
digits=3)
#LS-adjusted means
lsmeans(dm1.3,
pairwise~Treatment,
adjust="tukey")
#LS-adjusted means
lsmeans(dm1.3,
pairwise~Treatment*avg.inhab,
adjust="tukey")
#LS-adjusted means
lsmeans(dm1.3,
pairwise~Treatment,
adjust="tukey")
#LS-adjusted means
lsmeans(dm1.3,
pairwise~avg.inhab,
adjust="tukey")
#LS-adjusted means
behave$avg.inhab.fact<-as.factor(behave$avg.inhab)
lsmeans(dm1.3,
pairwise~avg.inhab.fact,
adjust="tukey")
dm1.3<-lme(total.dist.moved~Treatment+(Treatment*Year.fact)+
Year.fact+avg.inhab.fact,random=~1|Trial, behave, method = "REML")
hist(resid(dm1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.3))
qqline(resid(dm1.3))
anova(dm1.3)#type III anova = sig. treatment effect with ANOVA (III)
lsmeans(dm1.3,
pairwise~avg.inhab.fact,
adjust="tukey")
lsmeans(dm1.3,
pairwise~Treatment*avg.inhab.fact,
adjust="tukey")
#looking at average inhab*year result
bargraph.CI(x.factor = avg.inhab, response = total.dist.moved,
group= Year.fact, legend=TRUE, main="distance moved, by inhab and year",
xlab= "avg.inhab",data = behave)
dm1.3<-lme(total.dist.moved~Treatment+(Treatment*Year.fact)+
Year.fact+avg.inhab,random=~1|Trial, behave, method = "REML")
hist(resid(dm1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(dm1.3))
qqline(resid(dm1.3))
anova(dm1.3)#type III anova = sig. treatment effect with ANOVA (III)
#looking at average inhab effect
bargraph.CI(x.factor = avg.inhab, response = total.dist.moved,
legend=TRUE, main="distance moved, by inhab and year",
xlab= "avg.inhab",data = behave)
#looking at average inhab effect
bargraph.CI(x.factor = avg.inhab, response = total.dist.moved,
group = Treatment.ord,legend=TRUE, main="distance moved, by inhab and year",
xlab= "avg.inhab",data = behave)
#looking at average inhab effect as barplot, grouped by treatment
lineplot.CI(avg.inhab,total.dist.moved,group=Treatment.ord,legend = TRUE,
main="total dist moved x avg.inhab x trt", xlab="avg.inhab",
ylab="total dist moved", data=behave)
#running full model to make sure the reduced morel is correct
cr1.3.0<-lme(courtship.min~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3.0))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.3.0))
qqline(resid(cr1.3.0))
anova(cr1.3.0)
cr1.3<-lme(bites.min~Treatment+(Treatment*Year.fact)+
Year.fact,+avg.inhab,random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3))#looks like a slightly better model in terms of assumptions
cr1.3<-lme(bites.min~Treatment+(Treatment*Year.fact)+
Year.fact+avg.inhab,random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.3))
qqline(resid(cr1.3))
anova(cr1.3)#type III anova = sig. treatment effect with ANOVA (III)
cr1.3.1<-lme(proportion.exposed~Treatment*Year.fact,
random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.3.1))
qqline(resid(cr1.3.1))
anova(cr1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
Summarize(courtship.min~Treatment,
data=behave,
digits=3)
#LS-adjusted means
lsmeans(courtship.min,
pairwise~Treatment,
adjust="tukey")
#LS-adjusted means
lsmeans(cr1.3.1,
pairwise~Treatment,
adjust="tukey")
cr1.3<-lme(courtship.min~Treatment+(Treatment*Year.fact)+
Year.fact+avg.inhab,random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.3))
qqline(resid(cr1.3))
anova(cr1.3)#type III anova = sig. treatment effect with ANOVA (III)
cr1.3.1<-lme(courtship.min~Treatment*Year.fact,
random=~1|Trial, behave, method = "REML")
hist(resid(cr1.3.1))#looks like a slightly better model in terms of assumptions
qqnorm(resid(cr1.3.1))
qqline(resid(cr1.3.1))
anova(cr1.3.1)#type III anova = sig. treatment effect with ANOVA (III)
#running full model to make sure the reduced morel is correct
cr1.3.0<-lme(courtship.min~Treatment*Year.fact*avg.inhab,
random=~1|Trial, behave, method = "REML")
anova(cr1.3.0)
Summarize(courtship.min~Treatment,
data=behave,
digits=3)
#loading data
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
behave$avg.inhab<-(ceiling((behave$Recollection+20)/2))
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#exposure time####
exp<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment), mean))
exp$se<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
#library
library(ggplot2)
png("Output/2019.2.1.exposure.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(exp, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment", y="Proportion of Time Exposed") +
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.80))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#not sure why it's off the x axis now...has something to do with breaks
dev.off()
png("Output/2019.2.1.exposure.9.5x5.5.300dpi.png", width = 6.5, height = 5.7, units = 'in', res = 300)
reco.plot<- ggplot(exp, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment", y="Proportion of Time Exposed") +
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.80))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#not sure why it's off the x axis now...has something to do with breaks
dev.off()
png("Output/2019.2.1.exposure.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(exp, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment", y="Proportion of Time Exposed") +
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.801))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#not sure why it's off the x axis now...has something to do with breaks
dev.off()
png("Output/2019.2.1.exposure.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(exp, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment", y="Proportion of Time Exposed") +
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.807))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
#not sure why it's off the x axis now...has something to do with breaks
dev.off()
#courtship rate (displays per minute)####
cr<-with(behave, aggregate((courtship.min), list(Treatment=Treatment), mean))
cr$se<-with(behave, aggregate((courtship.min), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
reco.plot<- ggplot(cr, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Interactions with Conspecifics",
paste((displays~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.151))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
png("Output/2019.2.1.interactions.with.parentheses.9.5x5.5.300dpi.png", width = 6.5, height = 5.5, units = 'in', res = 300)
reco.plot<- ggplot(cr, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.5, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() +
labs(x="Risk Treatment",y=(expression(atop("Interactions with Conspecifics",
paste((displays~min^-1))))))+
theme(legend.position="none") +
scale_fill_manual(values=c("grey", "grey", "grey")) +
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0,0),limits = c(0,0.151))
reco.plot + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.85)) + theme(text = element_text(family="Arial"))
dev.off()
#loading df####
behave<-read.csv("Data/2019.10.25.behavior.includes.recollections.csv")
behave<-na.omit(behave)
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
# NOTE: there were no behavioral observations for trial 6
behave$Year <- ifelse(behave$Trial <=3, 2017, 2018)
#Going to make a variable with it as a factor, though I don't think it matters a whole lot
behave$Year.fact<- as.factor(behave$Year)
#making the variable "avg.inhab" ((20+reco)/2), rounded to the nearest whole fish
#using the average number of inhabitants per reef as the covariate
behave$avg.inhab<-(ceiling((behave$Recollection+20)/2))
write.csv(behave,"Data\\behavioral.data.with.avg.inhab", row.names = FALSE)
