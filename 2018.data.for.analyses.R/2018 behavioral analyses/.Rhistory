'Distance.moved.review.this.column'),factors='Treatment')
behave<-behave.2018.t4.5
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs = 'Density')
behave<-behave.2018.t6
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs = 'Density')
#2019.3.6 data with 2017 densities:
behave<-read.csv("Data/behavior.data.19.3.6.added.zeros.for.blanks.bites.csv")
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
#making behave = every trial df
behave<-behave.2017
#2019.3.6 data with 2017 densities:
behave<-read.csv("Data/behavior.data.19.3.6.added.zeros.for.blanks.bites.csv")
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
#making behave = every trial df
behave<-behave.2017
#2017
#NOTE: I didn't record densities during my 2017 observations
#added in density data in this manner:
#--1) if I recorded density for the day of the behavioral obs. then I used that density value
#--2) if I did not record density for the obs. day, then I averaged the densities taken
#--   from the two days around the observation day
#--3) I recorded the method from where I got density in the .csv file as "Method.for.den
#--   I only had to calculate average density for 5 of the reefs in 2017 (all in trial 2)
#--from observations only, which would allow me to enter these data into 2017 densities
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs='Density')
#different package for mancova
#seems like this could be the way to go, even though it might not satisfy all assumptions
#library(jmvcore)
library(jmv)
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs='Density')
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects
#easiest mancova package
library(jmv)
#easiest mancova package
library(jmv)
#2019.3.6 data with 2017 densities:
behave<-read.csv("Data/behavior.data.19.3.6.added.zeros.for.blanks.bites.csv")
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
behave<-behave.2018.t4.5
tapply(behave$Total.time.exposed, behave$Treatment, mean)
summary(mod1<-aov(Total.time.exposed~Treatment,data=behave))
TukeyHSD(mod1,"Treatment",ordered = TRUE)
plot(TukeyHSD(mod1,"Treatment"))
summary(mod1<-aov(Total.time.exposed~Treatment*Density,data=behave))
TukeyHSD(mod1,"Treatment",ordered = TRUE)
plot(TukeyHSD(mod1,"Treatment"))
# distance moved
tapply(behave$Distance.moved.review.this.column, behave$Treatment, mean)
# distance moved
#-- need to deal with NA values first
behave.a<-behave[!is.na(behave$Distance.moved.review.this.column),]
tapply(behave.a$Distance.moved.review.this.column, behave.a$Treatment, mean)
summary(mod1<-aov(Total.time.exposed~Treatment*Density,data=behave.a))
TukeyHSD(mod1,"Treatment",ordered = TRUE)
plot(TukeyHSD(mod1,"Treatment"))
plot(mod1)
#did gobies behave as expected based on treatment?
#looking at behaviors that differed within MANCOVA: time exposed, and distance moved
# exposure time
tapply(behave$Total.time.exposed, behave$Treatment, mean)
tapply(behave.a$Distance.moved.review.this.column, behave.a$Treatment, mean)
summary(mod1<-aov(Total.time.exposed~Treatment*Density,data=behave))
plot(mod1)
summary(mod1<-aov(Total.time.exposed~Treatment*Density,data=behave.a))
plot(mod1)
mod1<-aov(Total.time.exposed~Treatment*Density,data=behave)
plot(mod1)
summary(mod1<-aov(Distance.moved.review.this.column~Treatment*Density,data=behave.a))
mod1<-aov(Distance.moved.review.this.column~Treatment*Density,data=behave.a))
mod1<-aov(Distance.moved.review.this.column~Treatment*Density,data=behave.a)
plot(mod1)
View(behave.a)
#2019.3.6 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.12.csv")
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
library(jmv)
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column")]
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
#original MANCOVA
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#original MANCOVA
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs='Density')
behave<-behave.2018.t6
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#MANCOVA with corrected distances WITHOUT original distance moved
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
behave<-behave.2018.t4.5
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#MANCOVA with corrected distances WITHOUT original distance moved
#went with this analysis for the results that I reported to Mark
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment')
#MANCOVA with corrected distances WITHOUT original distance moved
#went with this analysis for the results that I reported to Mark
manova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment')
#MANCOVA with corrected distances WITHOUT original distance moved
#went with this analysis for the results that I reported to Mark
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment')
#MANCOVA with corrected distances WITHOUT original distance moved
#went with this analysis for the results that I reported to Mark
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#making behave = every trial df
behave<-behave.2017
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#making behave = every trial df
behave<-behave.2017
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.12.csv")
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.12.csv")
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
View(behave)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.12.csv")
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
"Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
"chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mod1<-mancova(cbind(Total.time.exposed,num.movement.swims,num.bites,
corrected.distance.moved)~Treatment,data=behave)
#differences in behavior among treatments?
mod1<-manova(cbind(Total.time.exposed,num.movement.swims,num.bites,
corrected.distance.moved)~Treatment,data=behave)
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
summary(mod1)
corrected.distance.moved,Density~Treatment,data=behave)
#differences in behavior among treatments?
mod1<-manova(cbind(Total.time.exposed,num.movement.swims,num.bites,
corrected.distance.moved,Density)~Treatment,data=behave)
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
summary(mod1)
#differences in behavior among treatments?
mod1<-manova(cbind(Total.time.exposed,num.movement.swims,num.bites,
corrected.distance.moved,Week)~Treatment,data=behave)
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
summary(mod1)
#differences in behavior among treatments?
mod1<-manova(cbind(Total.time.exposed,num.movement.swims,num.bites,
corrected.distance.moved)~Treatment,data=behave)
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
summary(mod1)
#MANCOVA with corrected distances WITHOUT original distance moved
#went with this analysis for the results that I reported to Mark
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#making behave = every trial df
behave<-behave.2017
#complete cases only
behave[complete.cases(behave),]
#complete cases only
behave[complete.cases(behave),]
behave<-behave.2018.t4.5
#complete cases only
behave[complete.cases(behave),]
behave<-behave.2018.t6
#complete cases only
behave[complete.cases(behave),]
#complete cases only
behave<-behave[complete.cases(behave),]
#making behave = every trial df
behave<-behave.2017
#complete cases only
behave<-behave[complete.cases(behave),]
#making behave = every trial df
behave<-behave.2017
View(behave)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv")
behave.2017<-behave[behave$Trial<4, ]
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
View(behave)
#complete cases only
behave<-behave[complete.cases(behave),]
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#look at ss by treatment:
library(plyr)
count(behave, "Treatment")
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
behave<-behave.2018.t4.5
View(behave)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, ]
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, ]
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
#complete cases only
behave<-behave[complete.cases(behave),]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
View(behave)
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#n per treatment with plyr package
count(behave, "Treatment")
behave<-behave.2018.t6
#complete cases only
behave<-behave[complete.cases(behave),]
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column'),factors='Treatment',covs = 'Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#n per treatment with plyr package
count(behave, "Treatment")
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'Distance.moved.review.this.column','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
mancova(data=behave, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#complete cases only
behave<-behave[complete.cases(behave),]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
#complete cases only
behave1<-behave[complete.cases(behave),]
mancova(data=behave1, deps=c('Total.time.exposed','num.movement.swims','num.bites',
'corrected.distance.moved','num.times.chased',
'num.times.chaser'),factors='Treatment',covs='Density')
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#did gobies behave as expected based on treatment?
#looking at behaviors that differed within MANCOVA: time exposed, and distance moved
# exposure time
tapply(behave$Total.time.exposed, behave$Treatment, mean)
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, ]
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
#did gobies behave as expected based on treatment?
#looking at behaviors that differed within MANCOVA: time exposed, and distance moved
# exposure time
tapply(behave$Total.time.exposed, behave$Treatment, mean)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, ]
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
#did gobies behave as expected based on treatment?
#looking at behaviors that differed within MANCOVA: time exposed, and distance moved
# exposure time
tapply(behave$Total.time.exposed, behave$Treatment, mean)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#subsetting data, only 2017
behave.2017<-behave[behave$Trial<4, ]
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, ]
#behave.2018.t6<-behave[behave$Trial>5, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                                                   "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                                                   "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#making behave = every trial df
behave<-behave.2017
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects)#adjusted means
#easiest mancova package
library(jmv)
#count(behave, "Treatment")
#2017 w/ complete cases:
#n = (high-54, low-55, medium-53)
count(d2, c("Reef","Treatment"))
#count(behave, "Treatment")
#2017 w/ complete cases:
#n = (high-54, low-55, medium-53)
count(behave, c("Reef","Treatment"))
#count(behave, "Treatment")
#2017 w/ complete cases:
#n = (high-54, low-55, medium-53)
count(behave, c("Reef","Treatment","Trial"))
ddply(behave, ~ Trial,
summarize, n_treatment = length(unique(Treatment)))
ddply(behave, ~ Trial,
summarize, n_treatment = length(c(unique(Treatment)&unique(Reef))))
behave[,length(unique(Reef)),by="Treatment,Reef"]
behave[,length(unique(Reef)),by="Treatment","Reef"]
xtabs( ~ Treatment + Reef, behave)
xtabs( ~ Treatment + Reef + Trial, behave)
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#complete cases only
behave<-behave[complete.cases(behave),]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
xtabs( ~ Treatment + Reef + Trial, behave)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#2018 data, only trial 6
behave.2018.t6<-behave[behave$Trial>5, ]
behave<-behave.2018.t6
#complete cases only
behave<-behave[complete.cases(behave),]
xtabs( ~ Treatment + Reef + Trial, behave)
