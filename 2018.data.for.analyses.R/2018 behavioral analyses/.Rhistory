png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=31,face="bold")) +
theme(axis.title.y = element_text(size= 31, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Courtship Displays")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=31,face="bold")) +
theme(axis.title.y = element_text(size= 31, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 800)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
for.means<-with(behave, aggregate((num.bites), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
for.means$se<-with(behave, aggregate((num.bites), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
behave$bites.min<-(behave$num.bites/5)
for.means<-with(behave, aggregate((bites.min), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
for.means$se<-with(behave, aggregate((bites.min), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Bites per Minute")
dev.off()
png(filename = "Output/foraging.wsn.png", width = 900, height = 800)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Bites per Minute")
dev.off()
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
exp.means<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
exp.means$se<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
exp.wsn<- ggplot(exp.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
exp.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Proportion of Time Exposed")
png(filename = "Output/exposure.wsn.png", width = 900, height = 800)
exp.wsn<- ggplot(exp.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
exp.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Proportion of Time Exposed")
dev.off()
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects)#adjusted means
#easiest mancova package
library(jmv)
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
head(behave)
#subsetting by year
behave.2017<-behave[behave$Trial<4, ]
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
mancova(data=behave.2017, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'Density')
mancova(data=behave.2017, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
plot(density~courtship.min,data=behave.2017)
plot(courtship.min~density,data=behave.2017)
abline(courtship.min~density,data=behave.2017)
abline(plot(courtship.min~density,data=behave.2017))
plot(courtship.min~density,data=behave.2017)
abline(plot(courtship.min~density,data=behave.2017))
abline(courtship.min~density)
mancova(data=behave.2018.t4.5, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
#plotting regressions for general idea
# 1) prop exposed by density
plot(proportion.exposed~density,data=behave.2018.t4.5)
boxplot(density~Treatemnt,data=behave.2018.t4.5)
boxplot(density~Treatment,data=behave.2018.t4.5)
'total.dist.moved','courtship.min'),factors='Treatment)
manova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movement.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
summary(man.2017)
# Look to see which differ
summary.aov(man.2017)
#2018
man.2018<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2018.t4.5)
summary(man.2018)#no diff overall
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
#subsetting by year
behave.2017<-behave[behave$Trial<4, ]
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#2017
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'recollection')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'recollection')
#low > med > high: trendlikely driven by differences between low and high treatments (i.e. low and med were very similar)
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
#plotting regressions for general idea
# 1) prop exposed by density
plot(proportion.exposed~recollection,data=behave.2018.t4.5)
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
summary(man.2017)#no diff overall
# Look to see which differ, running univatiate contrasts
summary.aov(man.2017)#no diff in any of the univariate contrasts
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects)#adjusted means
#easiest mancova package
library(jmv)
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#low > med > high: trendlikely driven by differences between low and high treatments (i.e. low and med were very similar)
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
#low > med > high: trendlikely driven by differences between low and high treatments (i.e. low and med were very similar)
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
tapply(behave.2018.t4.5$proportion.exposed, behave.2018.t4.5$Treatment, mean)
#subsetting by year
behave.2017<-behave[behave$Trial<4, ]
tapply(behave.2017$proportion.exposed, behave.2017$Treatment, mean)
#clear workspace
rm(list=ls())
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects)#adjusted means
#loading df####
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
head(behave)
#clear workspace
rm(list=ls())
#loading packages####
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
#loading df####
behave<-read.csv("Data/2019.4.25.behavior.ss.csv", na.strings = "") #doesn't include unnecessary NA's
behave<-read.csv("Data/2019.4.25.behavior.ss.csv")
behave<-read.csv("Data/2019.4.25.behavior.ss.csv", na.strings = "")
head(behave)
#going to test and see if it makes a difference in models if trial is coded
#as a factor instead of an integer
behave$tfactor<-behave$Trial
behave$tfactor<as.factor(behave$tfactor)
behave$tfactor<-as.factor(behave$tfactor)
#loading df####
behave<-read.csv("Data/2019.10.8.behavior.ss.csv", na.strings = "")
#going to test and see if it makes a difference in models if trial is coded
#as a factor instead of an integer
behave$tfactor<-as.factor(behave$Trial)
# 1) proportion of time exposed####
# without density in model
#trial different outcome if coded as a factor???
mod.ex.ti<-lmer(proportion.exposed~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.ex.ti))
qqnorm(resid(mod.ex.ti))
qqline(resid(mod.ex.ti))
anova(mod.ex.ti)
mod.ex.tf<-lmer(proportion.exposed~ Treatment  + (1|tfactor), data=behave)
hist(resid(mod.ex.tf))
qqnorm(resid(mod.ex.tf))
qqline(resid(mod.ex.tf))
anova(mod.ex.tf)
hist(resid(mod.ex.ti))
hist(resid(mod.ex.tf))
mod.ex.tf<-lmer(proportion.exposed~ Treatment  + (1|tfactor), data=behave)
hist(resid(mod.ex.tf))
qqnorm(resid(mod.ex.tf))
qqline(resid(mod.ex.tf))
anova(mod.ex.tf)
# 1) proportion of time exposed####
# without density in model
#trial different outcome if coded as a factor??? NO
mod.ex<-lmer(proportion.exposed~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.ex))
qqnorm(resid(mod.ex))
qqline(resid(mod.ex))
anova(mod.ex)
#grouped by trial
bargraph.CI(x.factor = Treatment, response = proportion.exposed,
group= Trial, legend=TRUE, main="proportion of time exposed, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = proportion.exposed,
legend=TRUE, main="proportion of time exposed, not grouped by trial",
data = behave)
#rerunning analysis as a mixed model ancova (density as covariate)
mod.ex.anc<-lmer(proportion.exposed~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.ex.anc))
qqnorm(resid(mod.ex.anc))
qqline(resid(mod.ex.anc))
anova(mod.ex.anc)
Anova(mod.ex.anc)
Anova(mod.ex)
Anova(mod.ex.anc, type = III)#Analysis of deviance, type II wald test = sig. trt. effect,
Anova(mod.ex.anc, type = II)#Analysis of deviance, type II wald test = sig. trt. effect,
Anova(mod.ex.anc)#Analysis of deviance, type II wald test = sig. trt. effect,
#2) movements per minute####
mod.mo<-lmer(movements.min~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.mo))
qqnorm(resid(mod.mo))
qqline(resid(mod.mo))
anova(mod.mo) # sig. effect
Anova(mod.mo) #sig.effect
#rerunning analysis as a mixed model ancova (density as covariate)
mod..mo.anc<-lmer(movements.min~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.mo.anc))#looks like a slightly better model in terms of assumptions
#rerunning analysis as a mixed model ancova (density as covariate)
mod.mo.anc<-lmer(movements.min~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.mo.anc))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mod.mo.anc))
qqline(resid(mod.mo.anc))
anova(mod.mo.anc)#type III anova = no treatment effect, no interactive effect
Anova(mod.mo.anc)#Analysis of deviance, type II wald test = sig. trt. effect,
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = movements.min,
group= Trial, legend=TRUE, main="movement rate, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = proportion.exposed,
legend=TRUE, main="movement rate, all trials combined",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = movements.min,
legend=TRUE, main="movement rate, all trials combined",
data = behave)
# 3) bites per minute####
mod.bi<-lmer(bites.min~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.bi))
qqnorm(resid(mod.bi))
qqline(resid(mod.bi))
anova(mod.bi) # sig. effect
Anova(mod.bi) #sig.effect
#rerunning analysis as a mixed model ancova (density as covariate)
mod.bi.anc<-lmer(bites.min ~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.bi.anc))#looks like a slightly better model in terms of assumptions
qqnorm(resid(mod.bi.anc))
qqline(resid(mod.bi.anc))
anova(mod.bi.anc)#type III anova = no treatment effect, no interactive effect
Anova(mod.bi.anc)#Analysis of deviance, type II wald test = sig. trt. effect,
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = bites.min,
group= Trial, legend=TRUE, main="bite rate, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = proportion.exposed,
legend=TRUE, main="bite rate, all trials combined",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = bites.min,
legend=TRUE, main="bite rate, all trials combined",
data = behave)
# 4) total distance moved####
mod.di<-lmer(total.dist.moved~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.di))
qqnorm(resid(mod.di))
qqline(resid(mod.di))
anova(mod.di) # no effect
Anova(mod.di) # no effect
#rerunning analysis as a mixed model ancova (density as covariate)
mod.di.anc<-lmer(bites.min ~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.di.anc))#looks about the same as ANOVA in terms of assumptions
qqnorm(resid(mod.di.anc))
#rerunning analysis as a mixed model ancova (density as covariate)
mod.di.anc<-lmer(total.dist.moved ~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.di.anc))#looks about the same as ANOVA in terms of assumptions
qqnorm(resid(mod.di.anc))
qqline(resid(mod.di.anc))
anova(mod.di.anc)#type III anova = no treatment effect, no interactive effect
Anova(mod.di.anc)#Analysis of deviance, type II wald test = no trt. effect,
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = total.distance.moved,
group= Trial, legend=TRUE, main="movement rate, grouped by trial",
data = behave)
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = total.dist.moved,
group= Trial, legend=TRUE, main="movement rate, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = total.dist.moved,
legend=TRUE, main="movement rate, all trials combined",
data = behave)
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = total.dist.moved,
group= Trial, legend=TRUE, main="linear distance moved (cm), grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = total.dist.moved,
legend=TRUE, main="linear distance moved (cm), all trials combined",
data = behave)
# courtship displays per minute####
mod.co<-lmer(courtship.min ~ Treatment  + (1|Trial), data=behave)
hist(resid(mod.co))
qqnorm(resid(mod.co))
qqline(resid(mod.co))
anova(mod.co) # no effect
Anova(mod.di) # no effect
#rerunning analysis as a mixed model ancova (density as covariate)
mod.co.anc<-lmer(courtship.min ~ Treatment * density  + (1|Trial), data=behave)
hist(resid(mod.co.anc))#better fit than ANOVA in terms of assumptions
qqnorm(resid(mod.co.anc))
qqline(resid(mod.co.anc))
anova(mod.co.anc)#type III anova = no treatment effect, no interactive effect
Anova(mod.co.anc)#Analysis of deviance, type II wald test = no trt. effect,
#plotting
#grouped by trial
bargraph.CI(x.factor = Treatment, response = courtship.min,
group= Trial, legend=TRUE, main="courtship rate, grouped by trial",
data = behave)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = courtship.min,
legend=TRUE, main="courship rate, all trials combined",
data = behave)
anova(mod.mo.anc)#type III anova = sig. treatment effect, no interactive effect
Anova(mod.mo.anc)#Analysis of deviance, type II wald test =  no trt. effect,
#no grouping factor
bargraph.CI(x.factor = Treatment, response = movements.min,
legend=TRUE, main="movement rate, all trials combined",
data = behave)
