exp.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Courtship Displays")
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=25, colour="black"),axis.text.y=element_text(size=25, colour="black"), axis.title=element_text(size=30,face="bold")) +
theme(axis.title.y = element_text(size= 30, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Proportion of Courtship Displays")
png(filename = "Output/courtship.wsn.png", width = 700, height = 600)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=25, colour="black"),axis.text.y=element_text(size=25, colour="black"), axis.title=element_text(size=30,face="bold")) +
theme(axis.title.y = element_text(size= 30, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Courtship Displays")
dev.off()
for.means<-with(behave, aggregate((num.bites), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
for.means$se<-with(behave, aggregate((num.bites), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
for.means
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=25, colour="black"),axis.text.y=element_text(size=25, colour="black"), axis.title=element_text(size=30,face="bold")) +
theme(axis.title.y = element_text(size= 30, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=25, colour="black"),axis.text.y=element_text(size=25, colour="black"), axis.title=element_text(size=30,face="bold")) +
theme(axis.title.y = element_text(size= 30, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
boxplot(courtship~Treatment, data=behave)#
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave.2018.t4.5<-behave.2018.t4.5[Treatment!="Control"]
behave.2018.t4.5<-behave.2018.t4.5[behave.2018.t4.t5$Treatment!="Control"]
behave.2018.t4.5<-subset(behave.2018.t4.5, Treatment!="Control")
behave.2018.t4.5
behave.2018.t4.5<-subset(behave.2018.t4.5, Treatment!="Control")
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.3.14.csv") #doesn't include unnecessary NA's
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave.2018.t4.5<-subset(behave.2018.t4.5, Treatment!="Control")
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#quick model, not sure if I can really say much about this one statistically
mod1<-lm(courtship~Treatment+Density,data=behave.2018.t4.5)
qqnorm(resid(mod1))
hist(resid(mod1))
#quick model, not sure if I can really say much about this one statistically
mod1<-glm(courtship~Treatment+Density,family=poisson,data=behave.2018.t4.5)
qqnorm(resid(mod1))
hist(resid(mod1))
#quick model, not sure if I can really say much about this one statistically
mod1<-glm(log(courtship+1)~Treatment+Density,family=poisson,data=behave.2018.t4.5)
qqnorm(resid(mod1))
hist(resid(mod1))
#quick model, not sure if I can really say much about this one statistically
mod1<-glm(log(courtship)~Treatment+Density,family=poisson,data=behave.2018.t4.5)
#quick model, not sure if I can really say much about this one statistically
mod1<-lm(log(courtship)~Treatment+Density,data=behave.2018.t4.5)
#quick model, not sure if I can really say much about this one statistically
mod1<-lm(log(courtship+1)~Treatment+Density,data=behave.2018.t4.5)
qqnorm(resid(mod1))
hist(resid(mod1))
#quick model, not sure if I can really say much about this one statistically
mod1<-glm(courtship~Treatment+Density,family=binomial,data=behave.2018.t4.5)
court.means<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
court.means<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
court.means<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave.2018.t4.5, aggregate((courtship), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
court.means<-with(behave, aggregate((courtship), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave, aggregate((courtship), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
court.means<-with(behave, aggregate((courtship), list(Treatment=Treatment), mean))
court.means
#complete cases only
behave<-behave[complete.cases(behave),]
court.means<-with(behave, aggregate((courtship), list(Treatment=Treatment), mean))
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2018.figures.color.BEM.R', echo=TRUE)
court.means
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave, aggregate((courtship), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
png(filename = "Output/courtship.wsn.png", width = 700, height = 600)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=25, colour="black"),axis.text.y=element_text(size=25, colour="black"), axis.title=element_text(size=30,face="bold")) +
theme(axis.title.y = element_text(size= 30, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Courtship Displays")
dev.off()
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
egg.den.bio<-read.csv("Data/jarvis.egg.count.data.with.den.max.2019.3.6.csv") #uses adjusted counts for density
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#making a new variable for all courtship interactions
behave$courtship<-behave$num.times.chased+behave$num.times.chaser
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
bahave$court.units<-(behave$courtship/5)
behave$court.units<-(behave$courtship/5)
court.means<-with(behave, aggregate((court.units), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
court.means$se<-with(behave, aggregate((court.units), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
court.means
png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=31,face="bold")) +
theme(axis.title.y = element_text(size= 31, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Courtship Displays")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=31,face="bold")) +
theme(axis.title.y = element_text(size= 31, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 700)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=28, colour="black"),axis.text.y=element_text(size=28, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/courtship.wsn.png", width = 900, height = 800)
court.wsn<- ggplot(court.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
court.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Courtship Displays per Minute")
dev.off()
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
for.means<-with(behave, aggregate((num.bites), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
for.means$se<-with(behave, aggregate((num.bites), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Bites")
dev.off()
behave$bites.min<-(behave$num.bites/5)
for.means<-with(behave, aggregate((bites.min), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
for.means$se<-with(behave, aggregate((bites.min), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/foraging.wsn.png", width = 700, height = 600)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Bites per Minute")
dev.off()
png(filename = "Output/foraging.wsn.png", width = 900, height = 800)
forage.wsn<- ggplot(for.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
forage.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Bites per Minute")
dev.off()
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
#2019.3.12 data with 2017 densities:
behave<-read.csv("Data/behavior.data.2019.4.4.csv") #doesn't include unnecessary NA's
#behave<-read.csv("Data/behavior.data.2019.3.12.csv") #includes data on gravidity, and tags of chaser/chasee
#data read in for packet of analyses: behave<-read.csv("Data/behavior.data.3.4.19.added.zeros.for.blanks.bites.csv")
#ordering treatments for better graphical visualization
behave$Treatment<-ordered(behave$Treatment,levels=c("Low","Medium","High"))
#behave.2017<-behave[behave$Trial<4, c("Year","Trial", "Reef", "Week","Days.after.deployment","Observer","Density","Goby.ID", "Treatment", "Density","Gravidity","Nearest.TOL","Starting.location",
#                                         "Starting.position","Total.time.exposed","proportion.exposed","Total.time.hidden","proportion.hidden","num.movement.swims","num.bites","num.times.chased",
#                                        "chased.by.size.tag","num.times.chaser","chaser.of.size.tag","area.used.cm","Distance.moved.review.this.column","corrected.distance.moved")]
#2018 data, only trials 4 and 5
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
behave<-behave.2018.t4.5
#complete cases only
behave<-behave[complete.cases(behave),]
exp.means<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
exp.means$se<-with(behave, aggregate((proportion.exposed), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
exp.wsn<- ggplot(exp.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
exp.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Proportion of Time Exposed")
png(filename = "Output/exposure.wsn.png", width = 900, height = 800)
exp.wsn<- ggplot(exp.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
exp.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Proportion of Time Exposed")
dev.off()
library(sciplot)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(plyr)
#packages needed for MANCOVA
library(car)#type III SS
library(psych)#descriptive statistics
library(effects)#adjusted means
#easiest mancova package
library(jmv)
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
head(behave)
#subsetting by year
behave.2017<-behave[behave$Trial<4, ]
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
mancova(data=behave.2017, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'Density')
mancova(data=behave.2017, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
plot(density~courtship.min,data=behave.2017)
plot(courtship.min~density,data=behave.2017)
abline(courtship.min~density,data=behave.2017)
abline(plot(courtship.min~density,data=behave.2017))
plot(courtship.min~density,data=behave.2017)
abline(plot(courtship.min~density,data=behave.2017))
abline(courtship.min~density)
mancova(data=behave.2018.t4.5, deps=c('Trial','proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'density')
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
#plotting regressions for general idea
# 1) prop exposed by density
plot(proportion.exposed~density,data=behave.2018.t4.5)
boxplot(density~Treatemnt,data=behave.2018.t4.5)
boxplot(density~Treatment,data=behave.2018.t4.5)
'total.dist.moved','courtship.min'),factors='Treatment)
manova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movement.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
summary(man.2017)
# Look to see which differ
summary.aov(man.2017)
#2018
man.2018<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2018.t4.5)
summary(man.2018)#no diff overall
behave<-read.csv("Data/2019.4.25.behavior.ss.csv") #doesn't include unnecessary NA's
#subsetting by year
behave.2017<-behave[behave$Trial<4, ]
behave.2018.t4.5<-behave[c((behave$Trial>3) & (behave$Trial<6)), ]
#2017
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'recollection')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment',covs = 'recollection')
#low > med > high: trendlikely driven by differences between low and high treatments (i.e. low and med were very similar)
boxplot(proportion.exposed~Treatment, data=behave.2018.t4.5)
#plotting regressions for general idea
# 1) prop exposed by density
plot(proportion.exposed~recollection,data=behave.2018.t4.5)
#running this as manova in base R, not with jmv package
man.2017<-manova(cbind(proportion.exposed,movements.min,bites.min,total.dist.moved,courtship.min)~Treatment, data=behave.2017)
summary(man.2017)#no diff overall
# Look to see which differ, running univatiate contrasts
summary.aov(man.2017)#no diff in any of the univariate contrasts
mancova(data=behave.2017, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
mancova(data=behave.2018.t4.5, deps=c('proportion.exposed','movements.min','bites.min',
'total.dist.moved','courtship.min'),factors='Treatment')
