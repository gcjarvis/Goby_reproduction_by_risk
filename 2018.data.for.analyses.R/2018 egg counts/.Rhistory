anc1
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
repro<-read.csv("Data/new.data.2019.9.30.csv")
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
repro<-read.csv("Data/new.data.2019.9.30.csv")
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
#mixed model####
mod.2<-lmer(Egg.count~ Treatment * Recollection + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
Anova(mod.2)
fixef(mod.2)
mod.ER<-lm(Egg.count~Recollection, data=repro)
hist(resid(mod.ER))
qqnorm(resid(mod.ER))
qqline(resid(mod.ER))
anova(mod.ER)
Anova(mod.ER)
summary(mod.ER)
egg.anc
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#making a B&W figure for this analysis####
repro$Treatment<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
#importing dataset, adding number of gobies on each reef, ordering treatments####
#includes a cloumn ("Treatment") where uncaged and HR are coded as "High"
#also includes a column ("T6.comparison") where uncaged and high are separated
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#ordering "Treatment" and "T.6.comparison"
repro$Treatment<-ordered(repro$Treatment, levels=c("Low","Medium","High"))
repro$T6.comparison<-ordered(repro$T6.comparison, levels=c("Low","Medium","High","Uncaged"))
#A. running models with combined HR factor and trial as both a fixed and random factor####
# 1) trial as a fixed factor (don't think this is justified)
mod.1<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=repro)
hist(resid(mod.1))
qqnorm(resid(mod.1))
qqline(resid(mod.1))
anova(mod.1)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = Egg.count,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = repro)
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
#a. no effect of treatment on output
#b. there was an effect of number of gobies on output
#bi. general trend seems to be, more gobies, higher reproduction,
#   regardless of trt, and this occurs independent of trial effects;
#   meaning that this is the trend even in Part A, w/trial as a fixed effect
#c. no interactive effects of treatment and number of gobies
summary(mod.2)
bargraph.CI(x.factor = Treatment, response = Egg.count,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = repro)
Anova(mod.2)
Anova(mod.2, type=III)
Anova(mod.2, type="III")
Anova(mod.2, type="II")
Anova(mod.2, type="I")
Anova(mod.2)
anova(mod.2)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
repro<-read.csv("Data/new.data.2019.9.30.csv")
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
#importing dataset, adding number of gobies on each reef, ordering treatments####
#includes a cloumn ("Treatment") where uncaged and HR are coded as "High"
#also includes a column ("T6.comparison") where uncaged and high are separated
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
#this is the metric that I will use as the covariate in all of the other analyses as well
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
#importing dataset, adding number of gobies on each reef, ordering treatments####
#includes a cloumn ("Treatment") where uncaged and HR are coded as "High"
#also includes a column ("T6.comparison") where uncaged and high are separated
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
#this is the metric that I will use as the covariate in all of the other analyses as well
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#model to see how reproduction increased with avg. inhabitants
mod.ai<-lm(Egg.count~avg.inhab, data=repro)
hist(resid(mod.ai))
qqnorm(resid(mod.ai))
qqline(resid(mod.ai))
anova(mod.ai)
Anova(mod.ai)
summary(mod.ai)
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
Anova(mod.2)
summary(mod.2)
Anova(mod.2, type = "III")
anova(mod.2, type = "III")
egg.means<-with(repro, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.means
#calculating differences
#med-low
8011.200/6993.857
6993.857*0.15
6993.857+1049.08
#low > high =
8011.200/6361.225
#med > high =
6993.857/6361.225 #
6993.857*1.15
6993.857*1.145462
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2)) #looks a little weird in the plot
repro$avg.inhab.no.round<-((repro$Recollection+20)/2) #looking at it this way too
png("Output/2019.11.10.test.300dpi.12x4.egg.no.round.png", width = 12, height = 4, units = 'in', res = 300)
#taller figure to see the distinction in recollections
#png("Output/2019.10.28.density.15x7.300dpi.combo.shorter.x.axis.png", width = 15, height = 7, units = 'in', res = 300)
anc<-ggplot(repro, aes(avg.inhab.no.round, Egg.count, color=Treatment, fill=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = FALSE) +
#facet_grid(. ~ Trial,labeller=labeller(Trial = labels.t4.5))  +
geom_point(size=3) +
theme_classic() +
#theme(strip.text = element_text(face="bold", size = 30))+
xlab("Average Number of Gobies") +
ylab("Reproduction per Reef") +
expand_limits(y=0) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0)))
anc + scale_color_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(legend.text=element_text(size=25)) +
theme(legend.title =element_text(size=30, face="bold"))
dev.off()
png("Output/2019.11.10.test.300dpi.12x4.egg.no.round.png", width = 12, height = 4, units = 'in', res = 300)
#taller figure to see the distinction in recollections
#png("Output/2019.10.28.density.15x7.300dpi.combo.shorter.x.axis.png", width = 15, height = 7, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
png("Output/2019.11.10.egg.15x7.300dpi.egg.rounded.png", width = 12, height = 8, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png("Output/2019.11.10.egg.10x6.300dpi.egg.rounded.png", width = 10, height = 6, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png("Output/2019.11.10.egg.10x6.300dpi.egg.rounded.png", width = 9, height = 5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png("Output/2019.11.10.egg.9.5x5.5.300dpi.egg.rounded.png", width = 9.5, height = 5.5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
#loading data
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2)) #looks a little weird in the plot
#setting up df
repro$Treatment<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
png("Output/2019.11.12.treatments.ordered.egg.9.5x5.5.300dpi.egg.rounded.png", width = 9.5, height = 5.5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
library(ggplot2)
#loading data
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2)) #looks a little weird in the plot
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Reproductive Output
(total eggs laid per reef)")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Reproductive Output
(total eggs laid per reef)")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
png("Output/2019.11.13.treatments.ordered.egg.parenthesis.9.5x5.5.300dpi.egg.rounded.png", width = 9.5, height = 5.5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Reproductive Output
(total eggs laid per reef)")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
#setting up df
repro$Treatment<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
png("Output/2019.11.12.treatments.ordered.egg.9.5x5.5.300dpi.egg.rounded.png", width = 9.5, height = 5.5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png("Output/2019.11.13.treatments.ordered.egg.parenthesis.9.5x5.5.300dpi.egg.rounded.png", width = 9.5, height = 5.5, units = 'in', res = 300)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(avg.inhab, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef", y="Reproductive Output
(total eggs laid per reef)")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
