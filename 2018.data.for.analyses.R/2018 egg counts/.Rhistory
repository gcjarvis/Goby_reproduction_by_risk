mod10a<-lm(Egg.count~Treatment*deployment.day,data=df)
#2a) now as random factor
mod10ai<-lmer(Egg.count~Treatment+deployment.day,data=df)
#2a) now as random factor
mod10ai<-lm(Egg.count~Treatment+deployment.day,data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
anova(mod10)
summary(mod10a)
#2018.t4.5
#1)  no effect of treatment, lower total reproduction with lower density
mod10<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
#df$Trial<-as.factor(df$Trial)
df<-egg.2018.t4.5 #2018 only
#2018.t4.5
#1)  no effect of treatment, lower total reproduction with lower density
mod10<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
plot(mod10)
#1a) sig ineraction for trt:week and trt:density, but not consistent among weeks
#both changes in direction and changes in relative position to each other
mod10a<-lm(Egg.count~Treatment*Density*Week,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
summary(mod10a)
plot(mod10a)
#1b) no sig. effect of trial
mod10b<-lm(Egg.count~Treatment*Density*Week*Trial,data=df)
hist(resid(mod10b))
qqnorm(resid(mod10b))
qqline(resid(mod10b))
anova(mod10b)
anova(mod10a)
#1c)
mod10b<-lm(Egg.count~Treatment*Density*Week*Trial*deployment.day,data=df)
hist(resid(mod10b))
qqnorm(resid(mod10b))
qqline(resid(mod10b))
anova(mod10b)
tapply(Egg.count,deployment.day,mean,data=df)
tapply(df$Egg.count,df$deployment.day,mean)
#1c) sig.effect of trt:den:dep.day
mod10b<-lm(Egg.count~Treatment*Density*Week*deployment.day,data=df)
hist(resid(mod10b))
qqnorm(resid(mod10b))
qqline(resid(mod10b))
anova(mod10b)
#1d)
mod10bi<-lm(Egg.count~Treatment*Density*deployment.day,data=df)
hist(resid(mod10bi))
qqnorm(resid(mod10bi))
qqline(resid(mod10bi))
anova(mod10bi)
#1e) dep.day as random factor
mod10bii<-lmer(Egg.count~Treatment*Density+(1|deployment.day),data=df)
hist(resid(mod10bii))
qqnorm(resid(mod10bii))
qqline(resid(mod10bii))
anova(mod10bii)
summary(mod10bii)
plot(mod10bii)
anova(mod10bii,type="I")
#1e) dep.day as random factor
mod10bii<-lmer(Egg.count~Treatment*Density+(1|Trial:deployment.day),data=df)
hist(resid(mod10bii))
qqnorm(resid(mod10bii))
qqline(resid(mod10bii))
anova(mod10bii,type="I")
summary(mod10bii)
ranef(mod10bii)
anova(mod10bii,type="I")
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
egg.den.bio<-read.csv("Data/jarvis.egg.count.data.with.den.max.2019.3.6.csv") #uses adjusted counts for density
#b. 2018 only
egg.2017.t1.2.3<-egg.den.bio[egg.den.bio$Trial<4,]
#c. 2018 t4 and t5 only only
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
#need to make a df that just contains the last trial (trial 6)
egg.2018.t6<-egg.den.bio[egg.den.bio$Trial==6,]
#df$Trial<-as.factor(df$Trial)
df<-egg.2018.t4.5 #2018 only
df<-egg.2018.t6
#df$Trial<-as.factor(df$Trial)
df<-egg.2018.t4.5 #2018 only
#a.ii eggs produced per treatment, regardless of time
bargraph.CI(x.factor = Treatment, response = Egg.count, legend=TRUE, main="2018 t4 + t5 total counts per treatment", xlab="Treatment", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
#df$Treatment<-factor(df$Treatment, ordered=FALSE)#unordered factor so I can interpret results
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High"))
#a.ii eggs produced per treatment, regardless of time
bargraph.CI(x.factor = Treatment, response = Egg.count, legend=TRUE, main="2018 t4 + t5 total counts per treatment", xlab="Treatment", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
require(graphics)
require(graphics)
# }
mod10<-aov(Egg.count~Treatment*Density,data=df)
TukeyHSD(mod10, "Treatment", ordered = TRUE)
TukeyHSD(mod10, c("Treatment","Density)", ordered = TRUE)
TukeyHSD(mod10, c("Treatment","Density)", ordered = TRUE))
# }
mod10<-aov(Egg.count~Treatment*Density,data=df)
TukeyHSD(mod10, c("Treatment","Density)", ordered = TRUE))
TukeyHSD(mod10, c("Treatment","Density"), ordered = TRUE))
TukeyHSD(mod10, c("Treatment","Density"), ordered = TRUE)
# }
mod10<-aov(per.capita.repro~Treatment,data=df)
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(per.capita.repro~Treatment,data=df))
# }
summary(mod10<-aov(per.capita.repro~deployment.day,data=df))
# }
summary(mod10<-aov(Egg.count~deployment.day,data=df))
TukeyHSD(mod10, c("deployment.day"), ordered = TRUE)
#2018.t4.5
#1)  no effect of treatment, lower total reproduction with lower density
mod10<-lm(Egg.count~Treatment*Density,data=df)
plot(mod10)
plot(mod10)
View(df)
# }
summary(mod10<-aov(Egg.count~Trial,data=df))
# }
summary(mod10<-aov(Egg.count~Week,data=df))
TukeyHSD(mod10, c("Week"), ordered = TRUE)
df$Week<-as.factor(df$Week)
# }
summary(mod10<-aov(Egg.count~Week,data=df))
TukeyHSD(mod10, c("Week"), ordered = TRUE)
# }
summary(mod10<-aov(Egg.count~Treatment*Density+(1|Trial:deployment.day),data=df))
# }
summary(mod10<-lmer(Egg.count~Treatment*Density+(1|Trial:deployment.day),data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
install.packages("emmeans")
#trying emmeans package to determine differences among treatments
library(emmeans)
emmeans(mod10, list(pairwise ~ Treatment), adjust = "tukey")
tapply(df$Egg.count,df$Treatment,mean)
# }
summary(mod10<-lmer(Egg.count~Treatment*Density+(1|Trial:deployment.day),data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(Egg.count~Treatment*Density,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(Egg.count~Treatment*Density*deployment.day,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(Egg.count~Treatment,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(per.capita.output~Treatment,data=df))
# }
summary(mod10<-aov(per.capita.repro~Treatment,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
# }
summary(mod10<-aov(Egg.count~Treatment,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
#c. 2018 t4 and t5 only only
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
# }
summary(mod10<-aov(Egg.count~Treatment,data=df))
TukeyHSD(mod10, c("Treatment"), ordered = TRUE)
#1a) sig ineraction for trt:week and trt:density, but not consistent among weeks
#both changes in direction and changes in relative position to each other
mod10a<-lm(Egg.count~Treatment*Density*Week,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
summary(mod10a)
plot(mod10a)
boxplot(Egg.count~Treatment,data=df) #equal variance
#2018 t6
df<-egg.2018.t6
df$Treatment<-as.ordered(df$Treatment,c("Low","Medium","High","Control"))
df$Treatment<-as.ordered(df$Treatment,levels=c("Low","Medium","High","Control"))
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High","Control"))
#egg vs. density:
plot(Egg.count~Density,main="egg count vs. density, 2018 t6", data=df)
abline(lm(df$Egg.count~df$Density), col="red")# regression line (y~x)
lines(lowess(df$Density,df$Egg.count), col="blue") # lowess line (x,y)
#egg vs. density: seems like repro increased with density
plot(per.capita.repro~Density,main="egg count vs. density, 2018 t6", data=df)
#egg vs. density: seems like repro increased with density
plot(Egg.count~Density,main="egg count vs. density, 2018 t6", data=df)
abline(lm(df$Egg.count~df$Density), col="red")# regression line (y~x)
lines(lowess(df$Density,df$Egg.count), col="blue") # lowess line (x,y)
#1)
#GOING WITH THIS ONE
mod10<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10))
#1)
mod10<-lm(Egg.count~Treatment,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
#2018 t6
df<-egg.2018.t6
#1)
mod10<-lm(Egg.count~Treatment,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
plot(mod10)
View(df)
#egg.2018<-den.avg.egg[den.avg.egg$Trial>3, c("Trial", "Reef", "Week", "Treatment", "Egg.count", "Density","per.capita.repro")]
#egg.2018<-egg.den.bio[egg.den.bio$Trial>3,]
#egg.2018$Treatment<-ordered(egg.2018$Treatment,levels=c("Low","Medium","High","Control"))
#egg.2018
#tail(egg.2018)#notice that I only ran 2-wk trials for trial 6
#I'm not sure if I mentioned that in the methods that I sent to Mark, maybe yes!
egg.2018.wk3.4<-egg.2018.t4.5[(egg.2018.t4.5$Week>2),]
df<-egg.2018.wk3.4
#df$Treatment<-factor(df$Treatment, ordered=FALSE)#unordered factor so I can interpret results
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High"))
##########A) Unadjusted egg counts by treatment by week#############
#2017.t1.2.3 analyses
mod1<-lm(Egg.count~Treatment, data=df)#not normal
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
anova(mod1)
mod6<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod6))
qqnorm(resid(mod6))
qqline(resid(mod6))
anova(mod6)
#1) no difference by treatment, didn't include density
#GOING WITH THIS ONE
mod10<-lm(Egg.count~Treatment*Week*Density,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
#1) no difference by treatment, didn't include density
#GOING WITH THIS ONE
mod10<-lm(Egg.count~Treatment*Week*Density,data=df)
#1) no difference by treatment, didn't include density
#GOING WITH THIS ONE
mod10<-lm(Egg.count~Treatment*Week,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
#1) no difference by treatment, didn't include density
#GOING WITH THIS ONE
mod10<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
plot(mod10)
mod12<-glmer(Egg.count~Treatment*Density+(1|Week),family=poisson,data=df)
hist(resid(mod12))
qqnorm(resid(mod12))
qqline(resid(mod12))
anova(mod12)
Anova(mod12)
summary(mod12)
plot(mod12)
ranef(mod12)
View(df)
#A. load data (egg counts and densities combined into one for raw counts and per capita)
#raw data for egg counts
gob.sub<-read.csv("Data/List of nests to count.1.10.19.csv")
df<-gob.sub
##########A) Unadjusted egg counts by treatment by week#############
#2017.t1.2.3 analyses
mod1<-lm(Egg.count~Treatment, data=df)#not normal
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
anova(mod1)
##########A) Unadjusted egg counts by treatment by week#############
#2017.t1.2.3 analyses
mod1<-glmer(Egg.count~Treatment+(1|Trial),family = poisson, data=df)#not normal
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
anova(mod1)
Anova(mod1)
plot(mod1)#looks like equal variance though
##########A) Unadjusted egg counts by treatment by week#############
#2017.t1.2.3 analyses
mod1<-glmer(Egg.count~Treatment*Week+(1|Trial),family = poisson, data=df)#not normal
hist(resid(mod1))
qqnorm(resid(mod1))
qqline(resid(mod1))
anova(mod1)
Anova(mod1)
Anova(mod1,type="III")
summary(mod1)
##########A) Unadjusted egg counts by treatment by week#############
#2017.t1.2.3 analyses
mod1<-lm(Egg.count~Treatment, data=df)#not normal
hist(resid(mod1))
#c. 2018 only by week total raw counts
bargraph.CI(x.factor = Week, response = Egg.count, group= Treatment, legend=TRUE, main="2018 total counts per treatment over time", xlab="Week", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = egg.2018)
#c. 2018 only by week total raw counts
bargraph.CI(x.factor = Week, response = Egg.count, group= Treatment, legend=TRUE, main="2018 total counts per treatment over time", xlab="Week", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
df<-egg.2018.t6
#1)
mod10<-lm(Egg.count~Treatment,data=df)
hist(resid(mod10))
qqnorm(resid(mod10))
qqline(resid(mod10))
anova(mod10)
summary(mod10)
plot(mod10)
#2) adding density to the model
mod10a<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
summary(mod10a)
plot(mod10a)
plot(Egg.count~Week,data=df) #total reproduction increases with density
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lm(Egg.count~Treatment*Densty*Week,data=df)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lm(Egg.count~Treatment*Density*Week,data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
plot(mod10ai)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lm(Egg.count~Treatment*Week,data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lmer(Egg.count~Treatment*Density+(1|Week),data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
ranef(mod10ai)
plot(mod10ai)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lmer(Egg.count~Treatment*Density,data=df)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
#2a) now adding week as a factor, because reproduction decreased over time
#not exactly sure how I feel about this, because density decreased by week
mod10ai<-lmer(Egg.count~Treatment*Density+(1|Week),data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
mod10aii<-lm(Egg.count~Treatment*Density*Week,data=df)
AIC(mod10ai,mod10aii)
AIC(mod10a,mod10ai,mod10aii)
#a.ii eggs produced per treatment, regardless of time
bargraph.CI(x.factor = Treatment, response = Egg.count, legend=TRUE, main="2018 t6 total counts per treatment", xlab="Treatment", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
df$Treatment<-ordered(df$Treatment,c("Low","Medium","High","Control"))
#a.ii eggs produced per treatment, regardless of time
bargraph.CI(x.factor = Treatment, response = Egg.count, legend=TRUE, main="2018 t6 total counts per treatment", xlab="Treatment", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
#2) adding density to the model
mod10a<-lm(Egg.count~Treatment*Density,data=df)
#2) adding density to the model
mod10a<-lm(Egg.count~Treatment*Density,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
df$Week<-as.factor(df$Week)
# }
summary(mod10<-aov(Egg.count~Week,data=df))
TukeyHSD(mod10, c("Week"), ordered = TRUE)
tapply(df$Egg.count,df$Treatment,mean)
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High","Control"))
tapply(df$Egg.count,df$Treatment,mean)
df<-egg.2017.t1.2.3#2017 only
#df$Treatment<-factor(df$Treatment, ordered=FALSE)#unordered factor so I can interpret results
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High"))
tapply(df$Egg.count,df$Treatment,mean)
anova(mod10a)
df<-egg.2017.t1.2.3#2017 only
#df$Treatment<-factor(df$Treatment, ordered=FALSE)#unordered factor so I can interpret results
df$Treatment<-ordered(df$Treatment,levels=c("Low","Medium","High"))
#a.ii eggs produced per treatment, regardless of time
bargraph.CI(x.factor = Treatment, response = Egg.count, main="2017 total counts per treatment", xlab="Treatment", ylab="Eggs per reef (mean +/- se)", x.leg=13, yleg=4500, data = df)
#2) adding deployment day into the model as fixed factor
#don't think it improved the model, slightly better fit overall (R^2 value)
#--but still not great
mod10a<-lm(Egg.count~Treatment*deployment.day,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
summary(mod10a)
plot(mod10a)
#2a) now as random factor
#doesn't improve the model very much
mod10ai<-lm(Egg.count~Treatment+deployment.day,data=df)
hist(resid(mod10ai))
qqnorm(resid(mod10ai))
qqline(resid(mod10ai))
anova(mod10ai)
summary(mod10ai)
plot(mod10ai)
#3) no effect of treatment or density on reproductive output
mod11aiv<-lmer(Egg.count~Treatment*Density+(1|Trial)+(1|Trial:deployment.day),data=df)
hist(resid(mod11aiv))
qqnorm(resid(mod11aiv))
qqline(resid(mod11aiv))
Anova(mod11aiv)
anova(mod11aiv,type='I')
Anova(mod11aiv)
summary(mod11aiv)
plot(mod11aiv)
ranef(mod11aiv)
#3) no effect of treatment or density on reproductive output
mod11aiv<-lmer(Egg.count~Treatment*Density+(1|Trial:deployment.day),data=df)
hist(resid(mod11aiv))
#3) no effect of treatment or density on reproductive output
mod11aiv<-lmer(Egg.count~Treatment+(1|Trial:deployment.day),data=df)
hist(resid(mod11aiv))
qqnorm(resid(mod11aiv))
hist(resid(mod11aiv))
qqnorm(resid(mod11aiv))
qqline(resid(mod11aiv))
Anova(mod11aiv)
anova(mod11aiv,type='I')
Anova(mod11aiv)
summary(mod11aiv)
ranef(mod11aiv)
#2) adding deployment day into the model as fixed factor
#don't think it improved the model, slightly better fit overall (R^2 value)
#--but still not great
mod10a<-lm(Egg.count~Treatment*deployment.day,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
#2a) now as random factor
#doesn't improve the model very much
mod10ai<-lm(Egg.count~Treatment+deployment.day,data=df)
anova(mod11aiv,type='I')
#2) adding deployment day into the model as fixed factor
#don't think it improved the model, slightly better fit overall (R^2 value)
#--but still not great
mod10a<-lm(Egg.count~Treatment*Trial,data=df)
hist(resid(mod10a))
qqnorm(resid(mod10a))
qqline(resid(mod10a))
anova(mod10a)
summary(mod10a)
plot(mod10a)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
#A. load data (egg counts and densities combined into one for raw counts and per capita)
#raw data for egg counts
gob.sub<-read.csv("Data/List of nests to count.1.10.19.csv")
egg.den.bio<-read.csv("Data/jarvis.egg.count.data.with.den.max.2019.3.6.csv") #uses adjusted counts for density
#b. 2018 only
egg.2017.t1.2.3<-egg.den.bio[egg.den.bio$Trial<4,]
df<-egg.2017.t1.2.3#2017 only
tapply(df$Egg.count,df$Trial,mean)
#c. 2018 t4 and t5 only only
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
#need to make a df that just contains the last trial (trial 6)
egg.2018.t6<-egg.den.bio[egg.den.bio$Trial==6,]
#df$Trial<-as.factor(df$Trial)
df<-egg.2018.t4.5 #2018 only
tapply(df$Egg.count,df$Trial,mean)
df<-egg.2018.t6
tapply(df$Egg.count,df$Trial,mean)
