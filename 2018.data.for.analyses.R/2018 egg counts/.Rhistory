library(car)
Anova(mod1.3)
fixef(mod1.3)
fixef(mod1.3)["Treatment.power"]
summary(mod1.3) #"Estimate" column is in this output. I can calculate effect sizes this way
#going to reun model with lme4 package
mod1.3<-lmer(egg.week~Treatment*Year+(1|Year:Trial), data=repro)
hist(resid(mod1.3))
qqnorm(resid(mod1.3))
qqline(resid(mod1.3))
anova(mod1.3)
Anova(mod1.3)
summary(mod1.3) #"Estimate" column is in this output. I can calculate effect sizes this way
summary(mod1.3) #"Estimate" column is in this output. I can calculate effect sizes this way
# nlme package
mod1.3<-lmer(egg.week~Treatment.power*Year+(1|Year:Trial), data=repower)
hist(resid(mod1.3))
qqnorm(resid(mod1.3))
qqline(resid(mod1.3))
anova(mod1.3)
Anova(mod1.3)
summary(mod1.3) #"Estimate" column is in this output. I can calculate effect sizes this way
powerSim(mod1.3)
powerSim(model1)
powerSim(mod1.3)
#will remove year?
mod1.3a<-lmer(egg.week~Treatment.power+(1|Year:Trial), data=repower)
powerSim(mod1.3a)
fixef(mod1.3a)["Treatment.power"] <- -389238.82
#rerunning power analysis to see what my power would be with that effect size
powerSim(mod1.3a)
abline(fixef(mod1.3))
abline(fixef(mod1.3a))
abline(fixef(mod1.3a))
install.packages("powerMediation")
#thid package, to test for power when there is more than one fixed effect
library(powerMediation)
powerInteract(110, 2, 3, 0.8, alpha = 0.05, nTests = 1)
powerInteract(110, 2, 3, 0.20, alpha = 0.05, nTests = 1)
library(lme4)
library(nlme)
library(car)
library(pwr)
library(tidyverse)
library(simr) #testing effect sizes of mixed models
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#loading data####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#my model
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),data=repro)
library(lmerTest)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#running the lmer model
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
hist(resid(mod2.2))
qqnorm(resid(mod2.2))
qqline(resid(mod2.2))
anova(mod2.2)
Anova(mod2.2)
summary(mod2.2)
summary(mod2.2)
fixed<-c(-6274.33,-6414.55,-5888.02,-6058.39,-5537.64,-6089.48,
-6127.15)
ranef(mod2.2)
#random intercepts for trials, clustered by year (have thesse values)
rand<-list(546.68241,-94.38653,-452.29588,290.42689,325.57428,-616.00117)
#residual variance
res<- 3769288
#rerunning model with specified parameters given from model
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand,
sigma = res, data=repro)
rand1<-list(546.68241,-94.38653)
#rerunning model with specified parameters given from model
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
#seeing if I can do without the parameter for VarCorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed,
sigma = res, data=repro)
# I don't think it likes that I have all these random intercepts, only wants 2 values
# - for the vector
rand1<-list(413133) #random intercept variance
#seeing if I can do without the parameter for VarCorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
rand1<-list(413133,-6058.39) #negative value is the estimate for Year.fact
#using rand1 for varcorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
mod.sim
#random intercept variance for trial nested within year
#intercept for nested factor is first, then year.fact (used same value as the one for fixedef)
#need to get the variance for Year.fact
var(Year.fact)
#running the lmer model
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact/Trial),
data=repro)
#running the lmer model
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
ranef(mod2.2)
summary(mod2.2)
Anova(mod2.2)
anova(mod2.2)
Anova(mod2.2)
anova(mod2.2)
#reduced model that I used for my analyses
#NOTE: this was constructed with nlme package, need to change to lmer
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
anova(mod2.2.luk)
summary(mod2.2.luk)
(summary(mod2.2)$coefficients[2,2])**2
(summary(mod2.2)$coefficients[2,2])**1
(summary(mod2.2)$coefficients[2,2])**2
(summary(mod2.2)$coefficients[1,2])**2
mod.view<-(summary(mod2.2)$coefficients)
View(mod.view)
View(mod.view)$coefficients
(summary(mod2.2)$coefficients[2,2])**2
(summary(mod2.2)$coefficients)
(summary(mod2.2)$coefficients[1,5])
(summary(mod2.2)$coefficients[1,5])**2
(summary(mod2.2)$coefficients[2,5])
(summary(mod2.2)$coefficients[3,5])
(summary(mod2.2)$coefficients[2,2])
(summary(mod2.2)$coefficients[2,4])
(summary(mod2.2)$coefficients[4,2])
#mine
vcov(m)[4,2]
#mine
vcov(mod2.2)[4,2]
(summary(mod2.2)$coefficients[4,2])**2 # [4,2] gets me to std.error for year
321.8912*(sqrt(2))
321.8912*(sqrt(110)) # = 455.2229
(summary(mod2.2)$coefficients[4,2])*2 # [4,2] gets me to std.error for year
(summary(mod2.2)$coefficients[4,2])*4 # [4,2] gets me to std.error for year
(summary(mod2.2)$coefficients[4,2])**4# [4,2] gets me to std.error for year
(summary(mod2.2)$coefficients[4,2])**2# [4,2] gets me to std.error for year
#using rand1 for varcorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
mod.sim
(summary(mod2.2)$coefficients[4,2])**2# [4,2] gets me to std.error for year
rand1<-list(413133,103614) #negative value is the estimate for Year.fact
#using rand1 for varcorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
mod.sim
rand1<-list(413133,-103614) #decided to go with the code for calculating variance of the intercept
#using rand1 for varcorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
mod.sim
(summary(mod2.2)$coefficients[4,2])**2
rand1<-list(413133,103614) #decided to go with the value for the variance of the slope for year
#using rand1 for varcorr
mod.sim<- makeLmer(egg.week~(Treatment*Year.fact)+Treatment+avg.inhab+
Year.fact+(1|Year.fact/Trial),fixef = fixed, VarCorr = rand1,
sigma = res, data=repro)
mod.sim
#mine
sim_treat <- powerSim(mod.sim, nsim=100, test = fcompare(y~Year.fact+Treatment))
sim_treat
#mine
sim_treat <- powerSim(mod.sim, nsim=100, test = fcompare(y~Year.fact+avg.inhab))
sim_treat
#mine
sim_treat <- powerSim(mod.sim, nsim=100, test = fcompare(egg.week~Year.fact+avg.inhab))
sim_treat
#mine
sim_treat <- powerSim(mod.sim, nsim=100, test = fcompare(egg.week~Year.fact))
sim_treat
#will remove year?
mod1.3a<-lmer(egg.week~Treatment.power+(1|Year:Trial), data=repower)
abline(fixef(mod1.3a))
pwr.f2.test(u = 2, v = 25, f2 = 0.40, sig.level = 0.05, power = NULL) #71%
library(pwr)
pwr.f2.test(u = 2, v = 25, f2 = 0.40, sig.level = 0.05, power = NULL) #71%
library(pwr)
rm(list=ls())
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
library(multcomp)
mmc1<-read.csv("Data/mmc1.csv")
mod1 <- aov(RESP ~ T * factor(AC) + Error(POP), data=mmc1)
mod1 <- aov(RESPONSE ~ TREAT * factor(AC) + Error(POP), data=mmc1)
summary(mod1)
summary(mod1)
#loading data
mmc1<-read.csv("Data/mmc1.csv")
#loading data
mmc1<-read.csv("Data/mmc1.csv")
#reformatted data and took cell means (means for each response for each )
mod1a <- aov(cell.means ~ TREAT * factor(AC) + Error(POP), data=mmc1)
summary(mod1a)
mmc1a<-na.omit(reprommc1)# for E design
mmc1a<-na.omit(mmc1)# for E design
#reformatted data and took cell means (means for each response for each )
mod1a <- aov(cell.means ~ TREAT * factor(AC) + Error(POP), data=mmc1a)
#loading data
mmc1<-read.csv("Data/mmc1.csv")
mod1 <- aov(RESPONSE ~ TREAT * factor(AC) + Error(POP), data=mmc1)
#reformatted data and took cell means (means for each response for each )
mod1a <- aov(cell.means ~ TREAT * factor(AC) + Error(POP), data=mmc1a)
library (lme4)
mod<-lmer(RESP~T*AC+(1+AC|POP),data=mmc1)
mod<-lmer(RESPONSE~TREAT*AC+(1+AC|POP),data=mmc1)
Anova(mod, type=c("II","III", 2, 3), test.statistic=c("F"))
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#subsetting data to do t6 comparison between HR caged and uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subsetting by multiple character factors within a variable. Awesome code!
repro.t6.comp<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
modg<-lmer(egg.week~Treatment*Year+(1+Year|Trial),data=repro)
Anova(modg, type=c("II","III", 2, 3), test.statistic=c("F"))
modg<-lmer(egg.week~Treatment*Year*avg.inhab+(1+Year|Trial),data=repro)
Anova(modg, type=c("II","III", 2, 3), test.statistic=c("F"))
repro$sqrt.egg<-sqrt(repro$egg.week)
mod.e<-lm(egg.week~Treatment*Trial*avg.inhab,data=repro)
summary(mod.e)
anova(mod.e)
anova(mod.e)
hist(resid(mod.e))
plot(mod.e)
mod.se<-lm(sqrt.egg~Treatment*Trial*avg.inhab,data=repro)
hist(resid(mod.se))
plot(mod.se)
summary(mod.se)
anova(mod.se)
#Note: I modeled this as fixed, just to test assumptions
mod.e<-lm(egg.week~Treatment*Year*Trial*avg.inhab,data=repro)
hist(resid(mod.e))
plot(mod.e)
summary(mod.e)
anova(mod.e)
mod.se<-lm(sqrt.egg~Treatment*Year*Trial*avg.inhab,data=repro)
hist(resid(mod.se))
plot(mod.se)
summary(mod.se)
anova(mod.se)
Nereis <- read.table(file = "Data/mixed.model.practice.zurr.et.al/Nereis.txt", header = TRUE, dec = ".")
names(Nereis)
dotchart(Nereis$concentration,
ylab= "Order of observations",
xlab= "Concentration", main= "Cleveland dotplot")
#now adding a grouping factor
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Order of observations",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
#now adding a grouping factor
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Nutrient",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
pairs(Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = TRUE, xlab = "nutrient",
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = FALSE, xlab = "nutrient", #varwidth sets width of boxplot to sample size
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = TRUE, xlab = "nutrient", #varwidth sets width of boxplot to sample size
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
library(lattice)
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt.txt", header = TRUE, dec = ".")
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt", header = TRUE, dec = ".")
names(TeethNitrogen)
pairs(TeethNitrogen)
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
pairs(repro)
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
library(multcomp)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
pairs(repro) #pretty cool
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Nutrient",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
dotchart(repro$egg.week,
groups = factor(repro$Treatment),
ylab= "egg per week",
xlab= "treatment", main= "Cleveland dotplot",
pch= repro$Treatment)
dotchart(repro$egg.week,
groups = factor(repro$Treatment),
ylab= "egg per week",
xlab= "treatment", main= "Cleveland dotplot",
pch= repro$egg.week)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(deltaˆ{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...),
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(deltaˆ{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(delta^{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="l",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
pairs(TeethNitrogen) #seems to be an increasing relationship between age and nitrogen
xyplot(X15N ~ Age|factor(Tooth), type="l",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
Clams <- read.table(file = "Data/mixed.model.practice.zurr.et.al/Clams.txt", header = TRUE, dec = ".")
pairs(Clams)
Clams$fMONTH<-factor(Clams$MONTH)
coplot(LNAFD~LNLENGTH|fMONTH, data=Clams)
coplot(egg.week~Treatment|Trial, data = repro)
coplot(egg.week~Treatment|Trial, data = repro)
#modeling clam regression
M1<- lm(LNAFD~LNLENGTH*fMONTH, data= Clams)
drop1<-(M1,test="F")
drop1(M1,test="F")
drop1(M1,test="F")
#modeling clam regression
M1<- lm(LNAFD~LNLENGTH*fMONTH, data= Clams)
drop1(M1,test="F")
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
E<-resid(M1)
hist(E,xlab="Residuals", main="")
plot(Clams$LNLENGTH,E,xlab="Log(Length)",
ylab="Residuals")
plot(Clams$fMONTH,E,xlab="Month",ylab="Residuals")
par(op)
#teeth data again, same exploration
TN<-TeethNitrogen
M2<-lm(X15~Age, subset = (TN$Tooth == "Moby"), data=TN)
M2<-lm(X15N~Age, subset = (TN$Tooth == "Moby"), data=TN)
op<-par(mfrow = c(2,2))
plot(M2, add.smooth = FALSE)
par(op)
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
Age.Moby<-TN$Age[TN$Tooth=="Moby"]
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
op<-par(mfrow = c(2,2))
plot(M2, add.smooth = FALSE) #also nice function to get all in one plane
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
par(op)
par(op)
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
rm(list=ls())
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt", header = TRUE, dec = ".")
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
#teeth data again, same exploration
TN<-TeethNitrogen
M2<-lm(X15N~Age, subset = (TN$Tooth == "Moby"), data=TN) #that subset function is handy...
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
Age.Moby<-TN$Age[TN$Tooth=="Moby"]
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
library(lattice)
abline(M2)
summary(M2)
