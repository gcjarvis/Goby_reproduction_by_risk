scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=20, colour="black"),axis.text.y=element_text(size=20, colour="black"), axis.title=element_text(size=25,face="bold")) +
theme(axis.title.y = element_text(size= 25, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=20, colour="black"),axis.text.y=element_text(size=20, colour="black"), axis.title=element_text(size=25,face="bold")) +
theme(axis.title.y = element_text(size= 25, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y=)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
png(filename = "Output/barplot.t.1.2.3.png", width = 900, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=20, colour="black"),axis.text.y=element_text(size=20, colour="black"), axis.title=element_text(size=25,face="bold")) +
theme(axis.title.y = element_text(size= 25, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
png(filename = "Output/barplot.t.1.2.3.png", width = 900, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=30, colour="black"),axis.text.y=element_text(size=30, colour="black"), axis.title=element_text(size=35,face="bold")) +
theme(axis.title.y = element_text(size= 35, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
png(filename = "Output/barplot.t.1.2.3.png", width = 900, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
png(filename = "Output/barplot.t.1.2.3.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
df<-egg.2018.t4.5
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.1.2.3.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
#setting up df's for plotting
df<-egg.2017.t1.2.3
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.1.2.3.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
df<-egg.2018.t4.5
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.4.5.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
ylim(0,4500)+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
ylim(0,4500)+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.2018.t4.5$Treatment<-ordered(egg.2018.t4.5$Treatment,levels=c("Low","Medium","High"))
df<-egg.2018.t4.5
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
ylim(0,4500)+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
ylim(0,5500)+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
ylim(0,5500)+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_discrete(expand = c(0, 4500))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 4500))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + ylim(0,5000)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + ylim(0,4500) + expand_limits(y=0)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + ylim(0,5000) + expand_limits(y=0)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + ylim(0,5000)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + ylim(-1,5000)
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 5000))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(limits = c(0, 5000))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = (0,
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 5000))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
png(filename = "Output/barplot.t.4.5.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
#setting up df's for plotting
df<-egg.2017.t1.2.3
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
egg.2017.t1.2.3$Treatment<-ordered(egg.2017.t1.2.3$Treatment,levels=c("Low","Medium","High"))
#setting up df's for plotting
df<-egg.2017.t1.2.3
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.1.2.3.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
df<-egg.2017.t6
egg.2017.t6$Treatment<-ordered(egg.2017.t6$Treatment,levels=c("Low","Medium","High","Control"))
df<-egg.2017.t6
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.6.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00","red")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
df<-egg.2017.t6
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.means
egg.den.bio<-read.csv("Data/jarvis.egg.count.data.with.den.max.2019.3.6.csv") #uses adjusted counts for density
#trial 6
egg.2017.t6<-egg.den.bio[(egg.den.bio$Trial>5),]
egg.2017.t6$Treatment<-ordered(egg.2017.t6$Treatment,levels=c("Low","Medium","High","Control"))
df<-egg.2017.t6
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.means
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/barplot.t.6.png", width = 700, height = 800)
egg.wsn<- ggplot(egg.means, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00","red")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.wsn + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Total Reproduction per Reef")
dev.off()
