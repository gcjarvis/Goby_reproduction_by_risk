library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/goby_reproduction.2020.4.9.csv")
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding egg/week variable to the dataset for comparisons among trials of differing length
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#making Year and Trial factors
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
#subsetting data from Trial 6 for comparison of caged vs. uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subset treatments, caged and uncaged only to test for cage effects
## Note that Treatment factor for trial 6 models should be replaced with "T6.comparison"
repro.t6<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
ranef(me)$Trial
ranef(me)
coef(me)$Trial
rand(me)
fix(me)
fixed(me)
anova(me)
me$coefficient
me$coeff
coef(me)
levels(repro$Treatment)
summary(me)
boxplot(egg.week~Treatment,repro)
#removing three-way interaction of random effect
me2<-update(me, .~. -(1|avg.inhab:Treatment:Trial))
me3<-update(me2, .~. -(1|Treatment:Trial))
me4<-update(me3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
#trial effect
me5<-update(me2,.~. -(1|Trial))
me6<-update(me4, .~. -(Treatment:Year:avg.inhab))
#now removing Year.fact:avg.inhab (the order of removal seems arbitrary, but that's the next one)
me7<-update(me6, .~. -(Year:avg.inhab))
me8<-update(me7, .~. -(Treatment:avg.inhab))
#LS-adjusted means from model
emmeans(me8, pairwise~Treatment) #warning message re: interactions, but I think it's okay
rand(me)
# 1c. same analysis with log-likelihood estimates, but with sqrt.eggs as response####
## all I have to do is change the orignial model
mes<-lmer(sqrt.egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
rand(mes)
anova(mes8)
#removing three-way interaction of random effect
mes2<-update(mes, .~. -(1|avg.inhab:Treatment:Trial))
mes3<-update(mes2, .~. -(1|Treatment:Trial))
mes4<-update(mes3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
#trial effect
mes5<-update(mes2,.~. -(1|Trial))
mes6<-update(mes4, .~. -(Treatment:Year:avg.inhab))
anova(mes6)
#now removing Year.fact:avg.inhab (the order of removal seems arbitrary, but that's the next one)
mes7<-update(mes6, .~. -(Year:avg.inhab))
anova(mes7)
mes8<-update(mes7, .~. -(Treatment:avg.inhab))
anova(mes8)
summary(mes8) # trial variance is still 6% of residual variance for random effects
anova(mes8)
mes13<-lm(sqrt.egg.week~T6.comparison*avg.inhab,data=repro.t6)
anova(mes13)
mes14<-lm(sqrt.egg.week~T6.comparison+avg.inhab,data=repro.t6)
anova(mes14)
boxplot(sqrt.egg.week~T6.comparison,data=repro.t6)# variances don't look too bad
# LS-means for treatment from model:
emmeans(mes14, pairwise~T6.comparison)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/goby_reproduction.2020.4.9.csv")
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding egg/week variable to the dataset for comparisons among trials of differing length
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#making Year and Trial factors
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
#subsetting data from Trial 6 for comparison of caged vs. uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subset treatments, caged and uncaged only to test for cage effects
## Note that Treatment factor for trial 6 models should be replaced with "T6.comparison"
repro.t6<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
me<-lmer(egg.week ~ Treatment*Year + (1|Trial) + (1|Treatment:Trial) +
+(1|Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
me<-lmer(egg.week ~ Treatment*Year + (1|Trial) + (1|Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
me<-lmer(sqrt.egg.week ~ Treatment*Year + (1|Trial) + (1|Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
#sqrt-transformed egg counts
me<-lmer(sqrt.egg.week ~ Treatment*Year + (1|Trial) + (1|Reef), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
#sqrt-transformed egg counts
me<-lmer(sqrt.egg.week ~ Treatment*Year*Reef + (1|Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
rm(list=ls())
rm(list=ls())
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/8_2_20_big_dataset_repro.csv")
repro$Year<- as.factor(repro1$Year)
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#intial data viz
pairs(repro)
#intial data viz
pairs(repro)
head(repro)
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
me<-lmer(egg.week ~ Treatment*Year*avg_den_24h + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
boxplot(egg.week~avg_den_24h,repro)
me$coeff
ranef(me)$Trial
coef(me)
rand(me)
levels(repro$Treatment.fact)
levels(repro$Treatment)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
#Order the treatments: Low --> Med --> High
repro$Treatment.ord<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
anc1<-ggplot(repro, aes(avg_inhab_24h, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=16)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg_den_24h, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=16)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg_den_max_seen, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=16)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
summary(me)
me<-lmer(sqrt.egg.week ~ Treatment*Year*avg_den_24h + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
me<-lmer(sqrt.egg.week ~ Treatment*Year*avg_den_max_seen + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
me<-lmer(egg.week ~ Treatment*Year*avg_den_max_seen + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
me<-lmer(egg.week ~ Treatment*Year*avg_den_max_seen + (1|Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
me<-lmer(sqrt.egg.week ~ Treatment*Year*avg_den_24h + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
me<-lmer(egg.week ~ Treatment*Year*avg_den_24h + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_24h)+(1|avg_den_24h:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
boxplot(egg.week~Treatment*Year,repro)
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$recollection_male_and_female+20)/2))
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
boxplot(egg.week~Treatment,repro)
boxplot(egg.week~Treatment*Year*avg_den_24h,repro)
boxplot(egg.week~avg_den_24h,repro)
boxplot(egg.week~Year,repro)
me<-lmer(egg.week ~ Treatment*Year*avg_den_max_seen + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg_den_max_seen)+(1|avg_den_max_seen:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me) #hmmm, looks like there's a three-way interaction now?
me<-lmer(egg.week ~ Treatment*Year*avg_den_max_seen*(Trial %in% Year), REML=F, repro)
me<-lm(egg.week ~ Treatment*Year*avg_den_max_seen*(Trial %in% Year), REML=F, repro)
me<-lm(egg.week ~ Treatment*Year*avg_den_max_seen*(Trial %in% Year), repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
me<-lm(egg.week ~ Treatment*Year*avg_den_max_seen+(Trial %in% Year), repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
anova(me)
me1<-update(me, .~. -(Treatment:Year:avg_den_max_seen:Trial))
summary(me1)
anova(me1)
me2<-update(me1, .~. -(Treatment:Year:avg_den_max_seen))
anova(me2)
me3<-update(me2, .~. -(Year:Trial))
anova(me3)
me4<-update(me3, .~. -(Year:avg_den_max_seen ))
anova(me4)
me5<-update(me4, .~. -(Treatment:avg_den_max_seen))
anova(me5)
me6<-update(me5, .~. -(Treatment:Year))
anova(me6)
emmeans(me6, pairwise~Treatment)
me<-lm(sqrt.egg.week ~ Treatment*Year*avg_den_max_seen+(Trial %in% Year), repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
summary(me)
anova(me)
me<-lm(egg.week ~ Treatment*Year*avg_den_max_seen+(Trial %in% Year), repro)
hist(resid(me))
qqnorm(resid(me))
mes<-lm(sqrt.egg.week ~ Treatment*Year*avg_den_max_seen+(Trial %in% Year), repro)
anova(me,mes)
mes<-lm(sqrt.egg.week ~ Treatment*Year*avg_den_max_seen+(Trial %in% Year), repro)
hist(resid(mes))
anova(mes)
boxplot(avg_den_24h~Treatment, repro)
re<-lm(avg_den_24h~Treament*Year*Density*Trial)
re<-lm(avg_den_24h~Treament*Year*Density*Trial, repro)
re<-lm(avg_den_24h~Treatment*Year*Density*Trial, repro)
#importing dataset####
repro<-read.csv("Data/8_2_20_big_dataset_repro.csv") #includes biomass, densities, and egg counts
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$recollection_male_and_female+20)/2))
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
re<-lm(avg_den_24h~Treatment*Year*Density*Trial, repro)
hist(resid(re))
qqnorm(resid(re))
anova(re)
anova(re)
re<-lm(avg_den_24h~Treatment*Year*Density*(Trial %in% Year), repro)
hist(resid(re))
qqnorm(resid(re))
anova(re)
me1<-update(re, .~. -(Treatment:Year:Density:Trial))
anova(me1)
me2<-update(me1, .~. -(Year:Density:Trial))
anova(me2)
me3<-update(me2, .~. -(Treatment:Year:Trial))
anova(me3)
me4<-update(me3, .~. -(Treatment:Year:Density))
anova(me4)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/8_2_20_big_dataset_repro.csv") #includes biomass, densities, and egg counts
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
head(repro)
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$recollection_male_and_female+20)/2))
#importing dataset####
repro<-read.csv("Data/8_10_20_big_dataset_repro.csv") #includes biomass, densities, and egg counts
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$recollection_male_and_female+20)/2))
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#subsetting data from Trial 6 for comparison of caged vs. uncaged treatments
repro.t6<-repro[repro$Trial==6,]
#subset treatments, caged and uncaged only to test for cage effects
## Note that Treatment factor for trial 6 models should be replaced with "T6_comparison"
repro.t6<-repro.t6[repro.t6$T6_comparison == "High" | repro.t6$T6_comparison == "Uncaged", ]
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
plot(me)
# 1c. same analysis with log-likelihood estimates, but with sqrt.eggs as response####
## all I have to do is change the orignial model
mes<-lmer(sqrt.egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
plot(mes)
hist(resid(mes))
qqnorm(resid(mes))
qqline(resid(mes))
plot(mes)
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
rand(me)
broom.mixed::tidy(me)
install.packages("broom.mixed")
library(broom.mixed)
install.packages('TMB', type = 'source')
install.packages('TMB', type = 'source')
install.packages("TMB", type = "source")
library(broom.mixed)
broom.mixed::tidy(me)
rand(me)
#removing three-way interaction of random effect
me2<-update(me, .~. -(1|avg.inhab:Treatment:Trial))
me3<-update(me2, .~. -(1|Treatment:Trial))
me4<-update(me3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
#trial effect
me5<-update(me2,.~. -(1|Trial))
anova(me4)
mod1<-lme(egg.week~Treatment*Year, random = ~1 + Year|Trial, data = repro)
library(nlme)
mod1<-lme(egg.week~Treatment*Year, random = ~1 + Year|Trial, data = repro)
anova(mod1)
library(nlme)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + Year|Trial, data = repro)
anova(mod_fina)
anova(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 1|Trial, data = repro)
anova(mod_final)
ranef(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + Year|Trial, data = repro)
ranef(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 0|Trial, data = repro)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 1|Trial, data = repro)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 1|Trial, data = repro)
anova(mod_final)
ranef(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 1|Trial:avg.inhab, data = repro)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + 1|Trial*avg.inhab, data = repro)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + Trial*avg.inhab, data = repro)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1|Trial, data = repro)
anova(mod_final)
ranef(mod_final)
summary(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1+ Year|Trial, data = repro)
summary(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + Treatment|Trial, data = repro)
anova(mod_final)
summary(mod_final)
#using nlme, seems to make more sense with the year factor?
mod_final<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1 + Year|Trial, data = repro)
anova(mod_final)
summary(mod_final)
ranef(mod_final)
anova(mod_final)
