axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")+
theme(legend.box.background = element_rect(colour = "black"))
anc1
#sort of lame that I had to code it like this to get the legend correct
dev.off()
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
png(filename = "Output/19.10.22.gray.ancova.png", width = 900, height = 800)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
png(filename = "Output/19.10.22.gray.ancova.png", width = 900, height = 800)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.unboxed.png", width = 900, height = 800)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Eggs Laid Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.2.png", width = 900, height = 800)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.3.png", width = 700, height = 800)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.3.png", width = 900, height = 700)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.4.png", width = 900, height = 700)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.4.png", width = 900, height = 600)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
png(filename = "Output/19.10.22.gray.ancova.legend.5.png", width = 900, height = 600)
#plot seems a little more realistic when I don't round to the nearest whole number (ceiling)
#building from the bottom, not including shape by treatment
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Reproduction Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#sort of lame that I had to code it like this to get the legend correc
dev.off()
install.packages("sjPlot")
install.packages("sjPlot")
install.packages("sjPlot")
install.packages("sjPlot")
install.packages("sjPlot")
library(sjplot)
library(sjPlot)
library("ggplot2", lib.loc="~/R/win-library/3.5")
detach("package:ggplot2", unload=TRUE)
library("ggplot2", lib.loc="~/R/win-library/3.5")
updateR()
library(installr)
updateR()
library(installr)
library(install.r)
#loading packages
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
install.packages("sciplot")
install.packages("lme4")
install.packages("car")
install.packages("lmerTest")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("MASS")
install.packages("nlme")
install.packages("pwr")
install.packages("HH")
install.packages("installr")
library(installr)
updateR()
updater()
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
installed.packages("dplyr")
install.packages("dplyr")
install.packages("car")
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
repro<-read.csv("Data/new.data.2019.9.30.csv")
#mixed model####
mod.2<-lmer(Egg.count~ Treatment * Recollection + (1|Trial), data=repro)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
#mixed model####
mod.2<-lmer(Egg.count~ Treatment * Recollection + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
Anova(mod.2)
fixef(mod.2)
#plotting relationship between recolelctions and egg count
plot(repro$Recollection, repro$Egg.count)
abline(lm(repro$Egg.count~repro$Recollection))
mod.ER<-lm(Egg.count~Recollection, data=repro)
hist(resid(mod.ER))
qqnorm(resid(mod.ER))
qqline(resid(mod.ER))
anova(mod.ER)
Anova(mod.ER)
summary(mod.ER)
#making a B&W figure for this analysis####
repro$Treatment<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
egg.anc<-with(repro, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc$se<-with(repro, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
repro<-read.csv("Data/new.data.2019.9.30.csv")
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
repro<-read.csv("Data/new.data.2019.9.30.csv")
#omitting rows with NA's to see if it changes analyses
repro<-na.omit(repro)
#mixed model####
mod.2<-lmer(Egg.count~ Treatment * Recollection + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
Anova(mod.2)
fixef(mod.2)
mod.ER<-lm(Egg.count~Recollection, data=repro)
hist(resid(mod.ER))
qqnorm(resid(mod.ER))
qqline(resid(mod.ER))
anova(mod.ER)
Anova(mod.ER)
summary(mod.ER)
egg.anc
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
#making a B&W figure for this analysis####
repro$Treatment<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
anc1<-ggplot(repro, aes(Recollection, Egg.count, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Number of Gobies Recollected", y="Total Egg Production Per Reef")+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
#importing dataset, adding number of gobies on each reef, ordering treatments####
#includes a cloumn ("Treatment") where uncaged and HR are coded as "High"
#also includes a column ("T6.comparison") where uncaged and high are separated
repro<-read.csv("Data/new.data.2019.9.30.csv", na.strings = "")
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#ordering "Treatment" and "T.6.comparison"
repro$Treatment<-ordered(repro$Treatment, levels=c("Low","Medium","High"))
repro$T6.comparison<-ordered(repro$T6.comparison, levels=c("Low","Medium","High","Uncaged"))
#A. running models with combined HR factor and trial as both a fixed and random factor####
# 1) trial as a fixed factor (don't think this is justified)
mod.1<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=repro)
hist(resid(mod.1))
qqnorm(resid(mod.1))
qqline(resid(mod.1))
anova(mod.1)
#no grouping factor
bargraph.CI(x.factor = Treatment, response = Egg.count,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = repro)
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
# 2) trial as a random factor
mod.2<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=repro)
hist(resid(mod.2))
qqnorm(resid(mod.2))
qqline(resid(mod.2))
anova(mod.2)
#a. no effect of treatment on output
#b. there was an effect of number of gobies on output
#bi. general trend seems to be, more gobies, higher reproduction,
#   regardless of trt, and this occurs independent of trial effects;
#   meaning that this is the trend even in Part A, w/trial as a fixed effect
#c. no interactive effects of treatment and number of gobies
summary(mod.2)
bargraph.CI(x.factor = Treatment, response = Egg.count,
legend=TRUE, main="all trials, HR combined w uncaged, no trial",
data = repro)
Anova(mod.2)
Anova(mod.2, type=III)
Anova(mod.2, type="III")
Anova(mod.2, type="II")
Anova(mod.2, type="I")
Anova(mod.2)
anova(mod.2)
