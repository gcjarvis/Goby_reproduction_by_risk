library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2019.7.12.adding.year.factor.R', echo=TRUE)
repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, Egg.count/4,
ifelse(Trial == 6, Egg.count/4, NA))))
repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, Egg.count/4,
ifelse(Trial == 6, Egg.count/2, NA))))
View(repro)
repro %>%
mutate(repro$egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, ceiling(Egg.count/4),
ifelse(Trial == 6, ceiling(Egg.count/2), NA))))
repro %>%
mutate(repro$egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
View(repro)
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
View(repro)
#now want to set up the new model, including new response ("egg.year") and year
mod2<-lmer(egg.week~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod.2))
#now want to set up the new model, including new response ("egg.year") and year
mod2<-lmer(egg.week~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod2))
qqnorm(resid(mod2))
qqline(resid(mod2))
anova(mod2)
mod2<-lmer(egg.week~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod1.1.1))
qqnorm(resid(mod1.1.1))
qqline(resid(mod1.1.1))
anova(mod1.1.1)
Anova(mod1.1.1)
summary(mod1.1.1) #see sig. effect of avg. inhab. (makes sense), year (makes sense), and avg.inhab*year (makes sense)
rm(list=ls())
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
mod2<-lmer(egg.week~Treatment*avg.inhab*Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod2))
qqnorm(resid(mod2))
qqline(resid(mod2))
anova(mod2)
#going to run reduced model, minus three-way interaction
mod2.3<-lmer(egg.week~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod2.3))
qqnorm(resid(mod2.3))
qqline(resid(mod2.3))
anova(mod2.3)
Anova(mod2.3)
summary(mod2.3) # same results, will check out a model comparison?
#going to run reduced model, minus three-way interaction
mod2.1<-lmer(egg.week~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod2.1))
qqnorm(resid(mod2.1))
qqline(resid(mod2.1))
anova(mod2.1)
Anova(mod2.1)
summary(mod2.1) # only factor that is sig. is the avg.inhab, will
#maybe running this reduced model
mod2.2<-lmer(egg.week~Treatment+avg.inhab+Year.fact+(1|Year.fact:Trial),
data=repro)
hist(resid(mod2.2))
qqnorm(resid(mod2.2))
qqline(resid(mod2.2))
anova(mod2.2)
Anova(mod2.2)
summary(mod2.2) # same results, will check out a model comparison?
#comparing new models
anova(mod2,mod2.1,mod2.2)
bargraph.CI(x.factor = Treatment.ord, response = egg.week,
group= Year.fact, legend=TRUE, main="Reproduction by risk and year",
data = repro, ylab="egg count")
#ordering "Treatment" and "T.6.comparison"
repro$Treatment.ord<-ordered(repro$Treatment, levels=c("Low","Medium","High"))
repro$T6.comparison.ord<-ordered(repro$T6.comparison, levels=c("Low","Medium","High","Uncaged"))
bargraph.CI(x.factor = Treatment.ord, response = egg.week,
group= Year.fact, legend=TRUE, main="Reproduction by risk and year",
data = repro, ylab="egg count")
bargraph.CI(x.factor = Treatment.ord, response = egg.week,
group= Trial, legend=TRUE, main="all trials, HR combined grouped by trial",
data = repro)
bargraph.CI(x.factor = avg.inhab, response = egg.week,
group= Year.fact, legend=TRUE, main="reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count",
data = repro)
lineplot.CI(avg.inhab,egg.week,group=Year.fact,legend = TRUE,main="reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count", data=repro)
bargraph.CI(x.factor = Treatment.ord, response = egg.week,
group= Trial, legend=TRUE, main="all trials, HR combined grouped by trial",
data = repro)
bargraph.CI(x.factor = avg.inhab, response = egg.week,
group= Year.fact, legend=TRUE, main="reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count",
data = repro)
bargraph.CI(x.factor = Treatment.ord, response = egg.week,
group= Year.fact, legend=TRUE, main="Reproduction per week between years",
data = repro, ylab="egg count per reef per week")
bargraph.CI(x.factor = avg.inhab, response = egg.week,
group= Year.fact, legend=TRUE, main="reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count",
data = repro)
bargraph.CI(x.factor = avg.inhab, response = egg.week,
group= Year.fact, legend=TRUE, main="weekly reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count per reef per week",
data = repro)
lineplot.CI(avg.inhab,egg.week,group=Year.fact,legend = TRUE,main="reproduction by number of gobies",
xlab="avg.inhab", ylab="egg count", data=repro)
View(repro)
View(repro)
#running this reduced model
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
hist(resid(mod2.2))
qqnorm(resid(mod2.2))
qqline(resid(mod2.2))
anova(mod2.2)
anova(mod2.2)
#comparing new models
anova(mod2,mod2.1,mod2.2) #mod 2.2 seems to be the best mdoel in terms of AIC
Anova(mod2.2)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2019.12.12.testing.out.l.schuster.code.nlme.R', echo=TRUE)
#modeling####
#original model with lme4, reduced model (from "2019.7.12.adding.year.factor" script)
mod1.3<-lmer(Egg.count~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact+(1|Year.fact:Trial), data=repro)
hist(resid(mod1.3))
qqnorm(resid(mod1.3))
qqline(resid(mod1.3))
anova(mod1.3)
anova(mod1.3)
Anova(mod1.3)
#modeling####
#original model with lme4, with weekly output per reef as response variable, shown is the reduced model
# - (from "2019.7.12.adding.year.factor" script)
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#modeling####
#original model with lme4, with weekly output per reef as response variable, shown is the reduced model
# - (from "2019.7.12.adding.year.factor" script)
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
hist(resid(mod2.2))
qqnorm(resid(mod2.2))
qqline(resid(mod2.2))
anova(mod2.2)
Anova(mod2.2)
summary(mod2.2) # same results, will check out a model comparison?
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
summary(mod2.luk)
summary(mlme)
summary(mod2.luk)
anova(mod2.luk, type='marginal')
#running reduced model
mod2.1.luk<-lme(egg.week~(Treatment*avg.inhab)+(avg.inhab*Year.fact)+Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.1.luk)
anova(mod2.1.luk, type='marginal')
anova(mod2.luk, type='marginal')
#running reduced model
mod2.1.luk<-lme(egg.week~(Treatment*Year.fact)+(avg.inhab*Year.fact)+(Treatment*avg.inhab)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
anova(mod2.1.luk, type='marginal')
#running further reduced model
mod2.1.luk<-lme(egg.week~(Treatment*Year.fact)+(avg.inhab*Year.fact)+(Treatment*avg.inhab)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.1.luk)
anova(mod2.1.luk, type='marginal')
#running further reduced model
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
anova(mod2.luk,mod2.1.luk,mod2.2.luk)
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2019.12.12.testing.out.l.schuster.code.nlme.R', echo=TRUE)
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
summary(mod2.luk)
anova(mod2.luk, type='marginal')
anova(mod2.2.luk, type='marginal')
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
summary(mod2.luk)
anova(mod2.luk, type='marginal')
#running reduced model
mod2.1.luk<-lme(egg.week~(Treatment*Year.fact)+(avg.inhab*Year.fact)+(Treatment*avg.inhab)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.1.luk)
anova(mod2.1.luk, type='marginal')
#running further reduced model
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
mod2.3.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Year.fact/Trial,repro,method="REML")
summary(mod2.3.luk)
anova(mod2.3.luk, type='marginal')
mod2.4.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=
list(~1|Year.fact,~1|Trial),repro,method="REML")
summary(mod2.4.luk)
anova(mod2.4.luk, type='marginal')
anova(mod2.2.luk, type='marginal')
#Arithmetic vs. LS means (takes model means into account)####
if(!require(FSA)){install.packages("FSA")}
if(!require(psych)){install.packages("psych")}
if(!require(lsmeans)){install.packages("lsmeans")}
if(!require(car)){install.packages("car")}
install.packages("lsmeans")
library(FSA)
library(psych)
library(lsmeans)
library(car)
Summarize(egg.week~Treatment,
data=repro,
digits=3)
#LS means, taking model into consideration
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
library(lsmeans)
lsmeans(mod2.2.luk,
pairwise~Treatment,
adjust="tukey")
mod2.4.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=
list(~1|Year,~1|Trial),repro,method="REML")
summary(mod2.4.luk)
anova(mod2.4.luk, type='marginal') #NaNs as well, not sure if I'll be able to specify
mod2.4.luk<-lme(egg.week~(Treatment*Year)+ Treatment+
avg.inhab+Year,random=
list(~1|Year,~1|Trial),repro,method="REML")
summary(mod2.4.luk)
anova(mod2.4.luk, type='marginal') #NaNs as well, not sure if I'll be able to specify
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#exporting wrangled data
write.csv(repro,"Data\\egg.counts.2019.12.23.csv", row.names = FALSE)
#running further reduced model
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
#modeling####
#original model with lme4, with weekly output per reef as response variable, shown is the reduced model
# - (from "2019.7.12.adding.year.factor" script)
mod2.2<-lmer(egg.week~Treatment*Year.fact+avg.inhab+(1|Year.fact:Trial),
data=repro)
hist(resid(mod2.2))
qqnorm(resid(mod2.2))
qqline(resid(mod2.2))
anova(mod2.2)
Anova(mod2.2)
summary(mod2.2) # same results, will check out a model comparison?
rm(list=ls())
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
mod2.4.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=
list(~1|Year.fact,~1|Trial),repro,method="REML")
summary(mod2.4.luk)
anova(mod2.4.luk, type='marginal') #NaNs as well, not sure if I'll be able to specify
#LS means, taking model into consideration
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
library(lsmeans)
lsmeans(mod2.2.luk,
pairwise~Treatment,
adjust="tukey") #gives warning that results may be misleading
Summarize(egg.week~Treatment,
data=repro,
digits=3)
#arithmetic means
library(FSA)
Summarize(egg.week~Treatment,
data=repro,
digits=3)
Summarize(egg.week~Treatment,
data=repro,
digits=3)
Summarize(egg.week~Treatment*avg.inhab,
data=repro,
digits=3)
lsmeans(mod2.2.luk,
pairwise~Treatment*avg.inhab,
adjust="tukey") #gives warning that results may be misleading
#lsmeans(model,
#        pairwise ~ Classroom,
#        adjust="tukey")
#
#testing trial as a fixed effect####
mod3.t<-lme(egg.week~Treatment*Year.fact*Trial*avg.inhab,data=repro)
#lsmeans(model,
#        pairwise ~ Classroom,
#        adjust="tukey")
#
#testing trial as a fixed effect####
mod3.t<-lme(egg.week~Treatment*Year.fact*Trial*avg.inhab,repro,method="REML")
#lsmeans(model,
#        pairwise ~ Classroom,
#        adjust="tukey")
#
#testing trial as a fixed effect####
mod3.t<-lm(egg.week~Treatment*Year.fact*Trial*avg.inhab,repro,method="REML")
#lsmeans(model,
#        pairwise ~ Classroom,
#        adjust="tukey")
#
#testing trial as a fixed effect####
mod3.t<-lm(egg.week~Treatment*Year.fact*Trial*avg.inhab,repro)
anova(mod3.t)
#trial had an effect, want to see graphically
repro$treatment.ordered<-ordered(repro$Treatment, levels=c("Low","Medium","High"))
#reproduction by treatment
bargraph.CI(x.factor = avg.inhab, response = Egg.count, group = treatment.ordered,
legend=TRUE, main="reproduction per avg.inhab",
data = repro)
#reproduction by treatment
bargraph.CI(x.factor = avg.inhab, response = egg.week, group = treatment.ordered,
legend=TRUE, main="reproduction per avg.inhab",
data = repro)
#reproduction by treatment
bargraph.CI(x.factor = avg.inhab, response = egg.week, group = Trial,
legend=TRUE, main="reproduction per avg.inhab",
data = repro)
#comparing this lm to the (full) mixed-model with trial nested within year
anova(mod3.t,mod2.luk)
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
#comparing this lm to the (full) mixed-model with trial nested within year
anova(mod3.t,mod2.luk)
#comparing this lm to the (full) mixed-model with trial nested within year
#doesn't work?
anova(mod3.t,mod2.luk)
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
#lsmeans(model,
#        pairwise ~ Classroom,
#        adjust="tukey")
#
#testing trial as a fixed effect####
#not sure it makes sense to run it this way
mod3.t<-lm(egg.week~Treatment*Year.fact*Trial*avg.inhab,repro)
#comparing this lm to the (full) mixed-model with trial nested within year
#doesn't work?
anova(mod3.t,mod2.luk)
aov(mod3.t,mod2.luk)
#comparing this lm to the (full) mixed-model with trial nested within year
#doesn't work?
Anova(mod3.t,mod2.luk)
#running further reduced model
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
anova(mod2.2.luk, type='marginal')
#running further reduced model
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.luk)
anova(mod2.2.luk, type='marginal')
#Lukas's model with nlme, let's do the full model and then reduce if needed
mod2.luk<-lme(egg.week~Treatment*Year.fact*avg.inhab,random=~1|Trial,repro,method="REML")
summary(mod2.luk)
anova(mod2.luk, type='marginal')
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2019.12.12.testing.out.l.schuster.code.nlme.R', echo=TRUE)
lsmeans(mod2.2.luk,
pairwise~Treatment,
adjust="tukey") #gives warning that results may be misleading
Summarize(egg.week~Treatment,
data=repro,
digits=3)
lsmeans(mod2.2.luk,
pairwise~Treatment*avg.inhab,
adjust="tukey") #gives warning that results may be misleading
#let's try multcomp package with my new models (nlme)
citation(package = "nlme")
library(multcomp)
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/2019.12.12.testing.out.l.schuster.code.nlme.R', echo=TRUE)
citation(package="multcomp")
#summary(glht(YOUR MODEL, linfct=mcp(YOUR FIXED FACTOR="Tukey")))
summary(glht(mod2.2.luk, linfct=mcp(Treatment="Tukey")))
#making sure that the factor is nesting correctly
mod2.2.luk<-lme(fixed= egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,
weights = varIdent((form=~1|Year.fact)) ,repro,method="REML")
#LS means, taking model into consideration
mod2.2.luk<-lme(egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,repro,method="REML")
summary(mod2.2.1.luk)
#making sure that the factor is nesting correctly
mod2.2.1.luk<-lme(fixed= egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,
weights = varIdent((form=~1|Year.fact)) ,repro,method="REML")
summary(mod2.2.1.luk)
anova(mod2.2.1.luk, type='marginal')
#making sure that the factor is nesting correctly
mod2.2.1.luk<-lme(fixed= egg.week~(Treatment*Year.fact)+ Treatment+
avg.inhab+Year.fact,random=~1|Trial,
weights = varIdent((form=~1|Year.fact)) ,repro,method="REML")
summary(mod2.2.1.luk)
anova(mod2.2.1.luk, type='marginal')
citation(package="lsmeans")
