mod.se<-lm(sqrt.egg~Treatment*Trial*avg.inhab,data=repro)
hist(resid(mod.se))
plot(mod.se)
summary(mod.se)
anova(mod.se)
#Note: I modeled this as fixed, just to test assumptions
mod.e<-lm(egg.week~Treatment*Year*Trial*avg.inhab,data=repro)
hist(resid(mod.e))
plot(mod.e)
summary(mod.e)
anova(mod.e)
mod.se<-lm(sqrt.egg~Treatment*Year*Trial*avg.inhab,data=repro)
hist(resid(mod.se))
plot(mod.se)
summary(mod.se)
anova(mod.se)
Nereis <- read.table(file = "Data/mixed.model.practice.zurr.et.al/Nereis.txt", header = TRUE, dec = ".")
names(Nereis)
dotchart(Nereis$concentration,
ylab= "Order of observations",
xlab= "Concentration", main= "Cleveland dotplot")
#now adding a grouping factor
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Order of observations",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
#now adding a grouping factor
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Nutrient",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
pairs(Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = TRUE, xlab = "nutrient",
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = FALSE, xlab = "nutrient", #varwidth sets width of boxplot to sample size
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
boxplot(concentration ~ factor(nutrient),
varwidth = TRUE, xlab = "nutrient", #varwidth sets width of boxplot to sample size
main = "Boxplot of concentration conditional on
nutrient", ylab = "concentration", data = Nereis)
library(lattice)
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt.txt", header = TRUE, dec = ".")
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt", header = TRUE, dec = ".")
names(TeethNitrogen)
pairs(TeethNitrogen)
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
pairs(repro)
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
library(multcomp)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
pairs(repro) #pretty cool
dotchart(Nereis$concentration,
groups = factor(Nereis$nutrient),
ylab= "Nutrient",
xlab= "Concentration", main= "Cleveland dotplot",
pch= Nereis$nutrient)
dotchart(repro$egg.week,
groups = factor(repro$Treatment),
ylab= "egg per week",
xlab= "treatment", main= "Cleveland dotplot",
pch= repro$Treatment)
dotchart(repro$egg.week,
groups = factor(repro$Treatment),
ylab= "egg per week",
xlab= "treatment", main= "Cleveland dotplot",
pch= repro$egg.week)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(deltaˆ{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...),
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="1",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(deltaˆ{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age | factor(Tooth), type = "l",
xlab = "Estimated age", col = 1,
ylab = expression(paste(delta^{15}, "N")),
strip = function(bg = 'white', ...)
strip.default(bg = 'white', ...),
data = TeethNitrogen)
xyplot(X15N ~ Age|factor(Tooth), type="l",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
pairs(TeethNitrogen) #seems to be an increasing relationship between age and nitrogen
xyplot(X15N ~ Age|factor(Tooth), type="l",
xlab = "Estimated age", col=1,
ylab= expression(paste(delta^{15},"N")),
strip = function(bg='white',...)
strip.default(bg='white',...),
data= TeethNitrogen)
Clams <- read.table(file = "Data/mixed.model.practice.zurr.et.al/Clams.txt", header = TRUE, dec = ".")
pairs(Clams)
Clams$fMONTH<-factor(Clams$MONTH)
coplot(LNAFD~LNLENGTH|fMONTH, data=Clams)
coplot(egg.week~Treatment|Trial, data = repro)
coplot(egg.week~Treatment|Trial, data = repro)
#modeling clam regression
M1<- lm(LNAFD~LNLENGTH*fMONTH, data= Clams)
drop1<-(M1,test="F")
drop1(M1,test="F")
drop1(M1,test="F")
#modeling clam regression
M1<- lm(LNAFD~LNLENGTH*fMONTH, data= Clams)
drop1(M1,test="F")
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
op<-par(mfrow= c(2,2), mar=c(5,4,1,2))
plot(M1, add.smooth = FALSE, which=1)
E<-resid(M1)
hist(E,xlab="Residuals", main="")
plot(Clams$LNLENGTH,E,xlab="Log(Length)",
ylab="Residuals")
plot(Clams$fMONTH,E,xlab="Month",ylab="Residuals")
par(op)
#teeth data again, same exploration
TN<-TeethNitrogen
M2<-lm(X15~Age, subset = (TN$Tooth == "Moby"), data=TN)
M2<-lm(X15N~Age, subset = (TN$Tooth == "Moby"), data=TN)
op<-par(mfrow = c(2,2))
plot(M2, add.smooth = FALSE)
par(op)
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
Age.Moby<-TN$Age[TN$Tooth=="Moby"]
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
op<-par(mfrow = c(2,2))
plot(M2, add.smooth = FALSE) #also nice function to get all in one plane
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
par(op)
par(op)
par(op)
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
rm(list=ls())
TeethNitrogen <- read.table(file = "Data/mixed.model.practice.zurr.et.al/TeethNitrogen.txt", header = TRUE, dec = ".")
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
#teeth data again, same exploration
TN<-TeethNitrogen
M2<-lm(X15N~Age, subset = (TN$Tooth == "Moby"), data=TN) #that subset function is handy...
N.Moby<-TN$X15N[TN$Tooth=="Moby"]
Age.Moby<-TN$Age[TN$Tooth=="Moby"]
plot(y=N.Moby,x=Age.Moby,
xlab="Estimated Moby Age",
ylab=expression(paste(delta^{15},"N Moby")))
par(op)
library(lattice)
abline(M2)
summary(M2)
library(sciplot)
library(lme4)
library(lmerTest)
library(car)
library(ggplot2)
library(dplyr)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
library(multcomp)
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#want it as a factor? Going to make a variable with it as a factor, run the model, and see if I get different results
repro$Year.fact<- as.factor(repro$Year)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#subsetting data to do t6 comparison between HR caged and uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subsetting by multiple character factors within a variable. Awesome code!
repro.t6.comp<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
#using lme4 package
moda<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Year/Trial),data=repro)
hist(resid(moda))
qqnorm(resid(moda))
qqline(resid(moda))
anova(moda)
anova(moda)
Anova(moda)
summary(moda) # same results, will check out a model comparison?
mod1<-lme(egg.week~Treatment*Year*avg.inhab, random = ~1+Treatment|Trial,data = repro)
summary(mod1)
mod1<-lme(egg.week~Treatment*Year*avg.inhab, random = ~1+Treatment|Trial, random = ~1|Trial, data = repro)
mod1<-lme(egg.week~Treatment*Year*avg.inhab, random = list(~1+Treatment|Trial, ~1|Trial), data = repro)
summary(mod1)
#using lme4 package
moda<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Treatment/Trial),data=repro)
hist(resid(moda))
qqnorm(resid(moda))
qqline(resid(moda))
anova(moda)
Anova(moda)
summary(moda) # not doing it right, denDF are incorrrect
#using lme4 package
moda<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Year/Trial),data=repro)
#using lme4 package
moda<-lmer(egg.week~Treatment*Year.fact*avg.inhab+(1|Year.fact/Trial),data=repro)
hist(resid(moda))
qqnorm(resid(moda))
qqline(resid(moda))
anova(moda)
Anova(moda)
summary(moda) # not doing it right, denDF are incorrrect
mod1<-lme(egg.week~Treatment*Year+avg.inhab, random = ~1+Treatment|Trial, data = repro)
summary(mod1)
anova(mod1)
mod1<-lme(egg.week~(Treatment*Year)+avg.inhab, random = ~1+Treatment|Trial, data = repro)
summary(mod1)
anova(mod1)
mod1<-lme(egg.week~Treatment*Year+(avg.inhab), random = ~1+Treatment|Trial, data = repro)
mod1<-lme(egg.week~Treatment*Year, random = ~1+Treatment|Trial, data = repro)
mod1<-lme(egg.week~Treatment*Year, random = ~1|Trial, data = repro)
summary(mod1)
mod1<-lme(egg.week~Treatment*Year+, random = ~1 + Treatment|Trial, data = repro)
mod1<-lme(egg.week~Treatment*Year, random = ~1 + Treatment|Trial, data = repro)
mod1<-lme(egg.week~Treatment*Year, random = ~1 + Year|Trial, data = repro)
summary(mod1)
emod<-lme(egg.week~Treatment*Year*avg.inhab+(1|Trial/Year),repro,method='ML')
emod<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial/Year),repro,method='ML')
summary(egg.mmff)
summary(emod)
summary(emod)
emod<-lme(egg.week~Treatment*Year*avg.inhab+random=(1|Trial:Year),repro,method='ML')
emod<-lme(egg.week~Treatment*Year*avg.inhab,random=(1|Trial:Year),repro,method='ML')
emod<-lme(egg.week~Treatment*Year*avg.inhab,random=(1|Trial:Year),repro,method='ML')
anova(emod)
anova(emod)
emod<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Trial/Year),repro,method='ML')
summary(emod) #got some error messages
anova(emod)# not the same, still a lot of error df in treatment
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(Treatment|Trial/Year),repro,method='ML')
summary(emod) #got some error messages
anova(emod)# not the same, still a lot of error df in treatment
emod<-lme(egg.week~Treatment*Year+avg.inhab,random= ~Treatment|Trial/Year,repro,method='ML')
summary(emod)
emod<-lme(egg.week~Treatment*Year*Trial+avg.inhab,random= ~Treatment|Trial:Year,repro,method='ML')
emod<-lmer(egg.week~Treatment*Year*Trial+avg.inhab+(Treatment|Trial:Year),repro,method='ML')
summary(emod)
anova(emod)
Anova(emod)
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(Treatment|Trial:Year),repro,method='ML')
summary(emod)
anova(emod)
Anova(emod)
summary(emod)
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(1+Treatment|Trial:Year),repro,method='ML')
summary(emod)
anova(emod)
Anova(emod)
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(0+Treatment|Trial:Year),repro,method='ML')
summary(emod)
anova(emod)
Anova(emod)
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Trial/Year),repro,method='ML')
emod<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Trial/Year),repro,method='REML')
emod<-lme(egg.week~Treatment*Year+avg.inhab,random=~1|Trial/Year,repro,method='REML')
summary(emod)
emod<-lme(egg.week~Treatment*Year+avg.inhab,random=~1+Treatment|Trial/Year,repro,method='REML')
summary(emod)
emod<-lme(egg.week~Treatment*Year+avg.inhab,random=~0+Treatment|Trial/Year,repro,method='REML')
summary(emod)
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~0+Treatment|Trial/Year,repro,method='REML')
summary(emod1)
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~-1+Treatment|Trial/Year,repro,method='REML')
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~-1+Treatment|Trial,repro,method='REML')
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~-1+Treatment|Trial:Year,repro,method='REML')
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~-1+Treatment|Trial/Year,repro,method='REML')
emod1<-lme(egg.week~Treatment*Year+avg.inhab,random=~1|Treatment:Trial,repro,method='ML')
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial),repro,method='ML')
anova(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial),repro,method='ML')
summary(emod)
summary(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial),repro)
summary(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial:Year),repro)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial/Year),repro)
summary(emod1)
anova(emod1)
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1|Treatment:Trial,repro)
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1|Treatment/Trial,repro)
summary(emod2)
anova(emod2)
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1|Treatment:Trial,repro)
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1|Treatment:Trial/Year,repro)
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1|Treatment:Trial,repro,method='ML')
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1+|Treatment:Trial|Year,repro,method='ML')
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1+Treatment|Trial:Year,repro,method='ML')
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1+Treatment|Trial:/Year,repro,method='ML')
emod2<-lme(egg.week~Treatment*Year+avg.inhab, random=~1+Treatment|Trial/Year,repro,method='ML')
summary(emod2)
anova(emod2)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial/Year),repro)
summary(emod1)
anova(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial)+(1|Trial/Year),repro,REML=FALSE)
summary(emod1)
anova(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Trial:Year),repro,REML=FALSE)
summary(emod1)
anova(emod1)
emod1<-lmer(egg.week~Treatment*Year+avg.inhab+(1|Treatment:Year:Trial),repro,REML=FALSE)
summary(emod1)
anova(emod1)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
library(multcomp)
#importing dataset, adding number of gobies on each reef, ordering treatments####
repro<-read.csv("Data/new.data.2019.9.30.csv")
repro<-na.omit(repro) # no NA's to omit
#data manipulation####
#adding column for average density, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#adding egg/week variable to the dataset
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
emod<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial/Year),repro,method='ML')
emod<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial/Year),repro,REML=FALSE)
summary(emod)
anova(emod)
emoda<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Trial:Year),repro,REML = FALSE)
summary(emoda)
emodb<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Trial:Year),repro,REML = FALSE)
emodb<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Trial/Year),repro,REML = FALSE)
summary(emodb)
anova(emodb)
emodb<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment*Trial+(Treatment|Trial:Year)),repro,REML = FALSE)
emodc<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment*Trial+(Treatment|Trial:Year)),repro,REML = FALSE)
summary(emodc)
anova(emodc)
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
anova(emodc)
emod<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year/Trial),repro,REML=FALSE)
summary(emod)
anova(emod)
emodx<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year/Trial),repro,REML=FALSE)
summary(emodx)
anova(emodx)
emodx<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year/Trial),repro)
summary(emodx)
anova(emodx)
emodx<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year/Trial),repro,REML=TRUE)
summary(emodx)
anova(emodx)
emodx<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year/Trial),repro,REML=FALSE)
summary(emodx)
anova(emodx)
emodxi<-lmer(egg.week~Treatment*Year*avg.inhab+(Treatment|Year) + (Treatment|Year:Trial),
repro,REML=FALSE)
summary(emodxi)
anova(emodxi)
Anova(emodxi)
anova(emodxi)
summary(emodxi)
new_variable<- Trial:Treatment
new_variable<- repro$Trial:repro$Treatment
view(new_variable)
View(new_variable)
emodxii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment),repro,REML=FALSE)
summary(emodxii)
anova(emodxii)
emodxii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment),repro,REML=TRUE)
summary(emodxii)
anova(emodxii)
emodxiii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment) + (avg.inhab|Trial:Treatment),
repro,REML=TRUE)
summary(emodxiii)
emodxiii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment) + (avg.inhab|Trial:Treatment),
repro,REML=TRUE)
anova(emodxiii)
emodxiv<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment) + (avg.inhab||Trial:Treatment),
repro,REML=TRUE)
summary(emodxiv)
anova(emodxiv)
new_variable<- repro$Trial*repro$Treatment #not as simple as this
#converting trial to a factor
repro$Trial.factor<-as.factor(repro$Trial)
new_variable<- repro$Trial.factor:repro$Treatment #not as simple as this
View(new_variable)
emodxii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|new_variable),repro,REML=TRUE)
summary(emodxii)
anova(emodxii)
emodxii<-lmer(egg.week~Treatment*Year*avg.inhab+(1|Trial:Treatment),repro,REML=TRUE)
summary(emodxii)
anova(emodxii)
emodx1<-lmer(egg.week~Treatment*Year*avg.inhab+(1|new_variable),repro,REML=TRUE)
summary(emodx1)
anova(emodx1)
#correlated slopes
emodx1<-lmer(egg.week~Treatment*Year*avg.inhab+(1|new_variable)
+ (avg.inhab|new_variable),repro,REML=TRUE)
summary(emodx1)
#uncorrelated slopes
emodx2<-lmer(egg.week~Treatment*Year*avg.inhab+(1|new_variable)
+ (avg.inhab||new_variable),repro,REML=TRUE)
summary(emodx2)
anova(emodx2)
