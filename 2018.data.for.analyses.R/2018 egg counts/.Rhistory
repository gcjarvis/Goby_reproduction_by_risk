theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 2000)) + #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 2000)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 2400)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
#2018.t6
egg.2018.t6$Treatment<-ordered(egg.2018.t6$Treatment,levels=c("Low","Medium","High","Control"))
egg.anc.2018.t6<-with(egg.2018.t6, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc.2018.t6$se<-with(egg.2018.t6, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 2400)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
egg.anc.2018.t6
egg.anc.2018.t4.5
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4100)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
ng(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4300)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4500)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
png(filename = "Output/2018.t6.thesis.png", width = 700, height = 800)
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(extrafont)
#for t4.5
egg.2018.t4.5<-read.csv("Data/new.data.2019.4.23.no.t6.csv", na.strings = "") #uses adjusted counts for density
#2018.t4.5
#note the change in y-axis scaling
egg.2018.t4.5$Treatment<-ordered(egg.2018.t4.5$Treatment,levels=c("Low","Medium","High"))
egg.anc.2018.t4.5<-with(egg.2018.t4.5, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc.2018.t4.5$se<-with(egg.2018.t4.5, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/2018.t4.5.bigger.thesis.png", width = 700, height = 800)#defense talk
egg.plot.2018<- ggplot(egg.anc.2018.t4.5, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 22000),breaks = c(5000,10000,15000,20000))
egg.plot.2018 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
png(filename = "Output/2018.t4.5.bigger.thesis.png", width = 800, height = 700)#defense talk
egg.plot.2018<- ggplot(egg.anc.2018.t4.5, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 22000),breaks = c(5000,10000,15000,20000))
egg.plot.2018 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
#plotting, not including anything baout recollections here
#2017
egg.2017$Treatment<-ordered(egg.2017$Treatment,levels=c("Low","Medium","High"))
egg.anc.2017<-with(egg.2017, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc.2017$se<-with(egg.2017, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/2017.bigger.thesis.png", width = 800, height = 700)#talk
egg.plot.2017<- ggplot(egg.anc.2017, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.plot.2017 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
#importing datasets, needed to eliminate control manually
#for t1.2.3
egg.2017<-read.csv("Data/new.data.2019.4.23.t1.3.csv", na.strings = "") #uses adjusted counts for density
#for t6
egg.2018.t6<-read.csv("Data/new.data.2019.4.23.csv", na.strings = "") #uses adjusted counts for density
egg.2018.t6<-egg.2018.t6[(egg.2018.t6$Trial>5), ]#subsetting t6 df, b/c lazy
#plotting, not including anything baout recollections here
#2017
egg.2017$Treatment<-ordered(egg.2017$Treatment,levels=c("Low","Medium","High"))
egg.anc.2017<-with(egg.2017, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc.2017$se<-with(egg.2017, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/2017.bigger.thesis.png", width = 800, height = 700)#talk
egg.plot.2017<- ggplot(egg.anc.2017, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800))
egg.plot.2017 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
#2018.t6
egg.2018.t6$Treatment<-ordered(egg.2018.t6$Treatment,levels=c("Low","Medium","High","Control"))
egg.anc.2018.t6<-with(egg.2018.t6, aggregate((Egg.count), list(Treatment=Treatment), mean))
egg.anc.2018.t6$se<-with(egg.2018.t6, aggregate((Egg.count), list(Treatment=Treatment),
function(x) sd(x)/sqrt(length(x))))[,2]
png(filename = "Output/2018.t6.bigger.thesis.png", width = 800, height = 700)#talk
egg.plot.2018.t6<- ggplot(egg.anc.2018.t6, aes(x=Treatment, y=x, fill=Treatment)) +
geom_bar(stat="identity", colour= "black", width = 0.7, position="dodge")+
scale_x_discrete(limits=c("Low","Medium","High","Control"))+
theme_classic() + theme(legend.position="none")  + #scale_fill_discrete(name="Sex",labels=c(" Male"," Female", " Transitional")) +
theme(legend.key.size = unit(1.3,'line')) +
scale_fill_manual(values=c("#0072B2","#009E73","#D55E00", "#899DA4")) +
theme(axis.text.x=element_text(size=32, colour="black"),axis.text.y=element_text(size=32, colour="black"), axis.title=element_text(size=37,face="bold")) +
theme(axis.title.y = element_text(size= 37, margin = margin(t = 0, r = 20, b = 0, l = 0)), axis.title.x = element_text(margin = margin(t = 25, r = 0, b = 0, l = 0)), axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(axis.ticks.x = element_blank()) + scale_y_continuous(expand = c(0, 0),limits = c(0, 4800)) #,breaks = c(5000,10000,15000,20000))
egg.plot.2018.t6 + geom_linerange(aes(ymin=x-se, ymax=x+se), size=0.5,
position=position_dodge(.7)) + theme(text = element_text(family="Arial")) +
labs(x="Risk Treatment", y="Number of Eggs Produced")
dev.off()
library(extrafont)
library(ggplot2)
library(sciplot)
library(dplyr)
library(plyr)
library(vegan)
library(psych)
library(lme4)
egg.den.bio<-read.csv("Data/jarvis.egg.count.data.with.den.max.2019.3.6.csv") #uses adjusted counts for density
#trials 4 and 5
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
egg.2018.t4.5$Treatment<-ordered(egg.2018.t4.5$Treatment,levels=c("Low","Medium","High"))
df<-egg.2018.t4.5
#generic code using df
egg.means<-with(df, aggregate((Egg.count), list(Treatment=Treatment), mean))
#now apply the se function to the 4th column [,3]
egg.means$se<-with(df, aggregate((Egg.count), list(Treatment=Treatment), function(x) sd(x)/sqrt(length(x))))[,2]
#have to set up means df in order to overlay diamonds on plot
means <- tapply(egg.2018.t4.5$Egg.count,egg.2018.t4.5$Treatment,mean)
points(means,col="red",pch=18)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Number of Eggs Produced",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
#updated data
egg.den.bio<-read.csv("Data/new.data.2019.4.16a.t1.5.csv", na.strings = "")
#trials 4 and 5
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
egg.2018.t4.5$Treatment<-ordered(egg.2018.t4.5$Treatment,levels=c("Low","Medium","High"))
#updated data
egg.den.bio<-read.csv("Data/new.data.2019.4.16a.t1.5.csv", na.strings = "")
#trials 4 and 5
egg.2018.t4.5<-egg.den.bio[(egg.den.bio$Trial>3) & (egg.den.bio$Trial<6), ]
egg.2018.t4.5$Treatment<-ordered(egg.2018.t4.5$Treatment,levels=c("Low","Medium","High"))
df<-egg.2018.t4.5
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Number of Eggs Produced",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
#have to set up means df in order to overlay diamonds on plot
means <- tapply(egg.2018.t4.5$Egg.count,egg.2018.t4.5$Treatment,mean)
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Number of Eggs Produced",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,notch=TRUE,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Total Reproduction per Reef",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
png(filename = "Output/baxplot.defense.t.6.png", width = 800, height = 700)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Total Reproduction per Reef",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
dev.off()
png(filename = "Output/baxplot.defense.t.6.png", width = 800, height = 700)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Gobies Recollected",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Gobies Recollected",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
dev.off()
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Gobies Recollected",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Gobies Observed per Reef",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
png(filename = "Output/baxplot.defense.t.6.png", width = 800, height = 700)
boxplot(Egg.count~Treatment,data=egg.2018.t4.5,
col=c("#0072B2","#009E73","#D55E00"),
ylab="Total Reproduction per Reef",xlab="Risk Treatment",
cex.lab=2.0, cex.axis=1.65,
par(family="sans"), par(font.lab=2), par(mar=c(5,6,4,1)+.1))
points(means,col="black",pch=23,bg="white",cex=2,lwd=1.5)
dev.off()
#same idea, but with density as categorical (L, M, H), and recollections
#for t1.2.3
egg.den.bio<-read.csv("Data/new.data.2019.4.23.t1.3.csv", na.strings = "") #uses adjusted counts for density
View(egg.den.bio)
#for t4.5
egg.den.bio<-read.csv("Data/new.data.2019.4.23.no.t6.csv", na.strings = "") #uses adjusted counts for density
View(egg.den.bio)
egg.den.bio$avg.inhab<-((egg.den.bio$Recollection+20)/2))
egg.den.bio$avg.inhab<-((egg.den.bio$Recollection+20)/2)
View(egg.den.bio)
#broken down by trial for ANCOVA with jmv package (hopefully)
#adding extra column for average number of fish on the reef throughout the trials
egg.den.bio.t1.3<-read.csv("Data/new.data.2019.4.23.t1.3.csv", na.strings = "") #uses adjusted counts for density
egg.den.bio.t1.3$avg.inhab<-((egg.den.bio$Recollection+20)/2)
View(egg.den.bio.t1.3)
egg.den.bio.t1.3$avg.inhab<-((egg.den.bio.t1.3$Recollection+20)/2)
View(egg.den.bio.t1.3)
library(sciplot)
library(lme4)
library(car)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(MASS)
library(nlme)
library(pwr)
library(HH)#for ancova and plots
library(vegan)
rm(list=ls())
#broken down by trial for ANCOVA with jmv package (hopefully)
#adding extra column for average number of fish on the reef throughout the trials
egg.t1.3<-read.csv("Data/new.data.2019.4.23.t1.3.csv", na.strings = "") #uses adjusted counts for density
egg.t1.3$avg.inhab<-((egg.t1.3$Recollection+20)/2)
View(egg.t1.3)
#for t4.5
egg.t4.5<-read.csv("Data/new.data.2019.4.23.no.t6.csv", na.strings = "") #uses adjusted counts for density
egg.t4.5$avg.inhab<-((egg.t4.5$Recollection+20)/2)
#for t6
egg.t6<-read.csv("Data/new.data.2019.4.23.csv", na.strings = "") #uses adjusted counts for density
egg.t6$avg.inhab<-((egg.t6$Recollection+20)/2)
egg.t6<-egg.t6[egg.t6$Trial==6,]
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment * avg.inhab, data=egg.t1.3)
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment + avg.inhab, data=egg.t1.3)
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment * avg.inhab, data=egg.t1.3)
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment * avg.inhab * Trial, data=egg.t1.3)
egg.t1.3$Trial<-as.factor(egg.t1.3$Trial)
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment * avg.inhab * Trial, data=egg.t1.3)
#models and plots (maybe)
#2017
ancova(Egg.count ~ Treatment * Trial + avg.inhab , data=egg.t1.3)
#models and plots (maybe)
#can run linear models, don't need to call them ancovas
#2017
mod.2017<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t1.3)
anova(mod.2017)
#models and plots (maybe)
#can run linear models, don't need to call them ancovas
#2017
ancova(Egg.count ~ Trial * avg.inhab, data=egg.t1.3) #interaction between inhab and trial
ancova(Egg.count ~ Treatment * Trial, data=egg.t1.3) #interaction between inhab and trial
egg.t1.3<-read.csv("Data/new.data.2019.4.23.t1.3.csv", na.strings = "") #uses adjusted counts for density
egg.t1.3$avg.inhab<-((egg.t1.3$Recollection+20)/2)
ancova(Egg.count ~ Treatment * Trial, data=egg.t1.3) #interaction between inhab and trial
mod.2017<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t1.3)
anova(mod.2017)
hist(resid(mod.2017))
qqnorm(resid(mod.2017))
qqline(resid(mod.2017))
anova(mod.2017)
#trial as a random factor
mod.2017<-glm(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3))
#trial as a random factor
mod.2017<-glm(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3)
#trial as a random factor
mod.2017a<-glm(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3)
#trial as a fixed factor
mod.2017<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t1.3)
#trial as a random factor
mod.2017a<-glm(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3)
Anova(mod.2017a)
hist(resid(mod.2017a))
hist(resid(mod.2017a))
qqnorm(resid(mod.2017a))
qqline(resid(mod.2017a))
Anova(mod.2017a)
anova(mod.2017a)
hist(resid(mod.2017a))
qqnorm(resid(mod.2017a))
qqline(resid(mod.2017a))
Anova(mod.2017a)
#trial as a random factor
mod.2017a<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3)
hist(resid(mod.2017a))
qqnorm(resid(mod.2017a))
qqline(resid(mod.2017a))
Anova(mod.2017a)
anova(mod.2017a)
#trial as a fixed factor
mod.2017<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t1.3)
hist(resid(mod.2017))
qqnorm(resid(mod.2017))
qqline(resid(mod.2017))
anova(mod.2017)
#trial as a random factor
mod.2017a<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t1.3)
hist(resid(mod.2017a))
qqnorm(resid(mod.2017a))
qqline(resid(mod.2017a))
anova(mod.2017a)
#2018.t4.5
#trial as a fixed factor
mod.2018.t.4.5<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
qqnorm(resid(mod.2018.t.4.5))
qqline(resid(mod.2018.t.4.5))
anova(mod.2018.t.4.5)
#trial as a random factor
mod.2018.t.4.5<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
qqnorm(resid(mod.2018.t.4.5))
qqline(resid(mod.2018.t.4.5))
anova(mod.2018.t.4.5)
ancova(Egg.count ~ Trial * avg.inhab, data=egg.t4.5) #interaction between inhab and trial
#models and plots (maybe)
#can run linear models, don't need to call them ancovas
#2017
ancova(Egg.count ~ Trial * avg.inhab, data=egg.t1.3) #interaction between inhab and trial
ancova(Egg.count ~ Treatment * avg.inhab, data=egg.t4.5) #interaction between inhab and trial
ancova(Egg.count ~ Treatment * Trial, data=egg.t4.5) #interaction between inhab and trial
#2018.t4.5
#trial as a fixed factor
mod.2018.t.4.5<-lm(Egg.count ~ Treatment * avg.inhab *Trial, data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
qqnorm(resid(mod.2018.t.4.5))
qqline(resid(mod.2018.t.4.5))
anova(mod.2018.t.4.5)
#trial as a random factor
mod.2018.t.4.5<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
#trial as a random factor
mod.2018.t.4.5<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
qqnorm(resid(mod.2018.t.4.5))
qqline(resid(mod.2018.t.4.5))
#trial as a random factor
mod.2018.t.4.5a<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5))
qqnorm(resid(mod.2018.t.4.5))
#trial as a random factor
mod.2018.t.4.5a<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5a))
qqnorm(resid(mod.2018.t.4.5a))
qqline(resid(mod.2018.t.4.5a))
anova(mod.2018.t.4.5a)
#trial as a random factor
mod.2018.t.4.5a<-glmer(Egg.count~ Treatment * avg.inhab + (1|Trial),family=poisson, data=egg.t4.5)
hist(resid(mod.2018.t.4.5a))
qqnorm(resid(mod.2018.t.4.5a))
qqline(resid(mod.2018.t.4.5a))
anova(mod.2018.t.4.5a)
Anova(mod.2018.t.4.5a)
#trial as a random factor
mod.2018.t.4.5a<-lmer(Egg.count~ Treatment * avg.inhab + (1|Trial), data=egg.t4.5)
hist(resid(mod.2018.t.4.5a))
qqnorm(resid(mod.2018.t.4.5a))
qqline(resid(mod.2018.t.4.5a))
anova(mod.2018.t.4.5a)
Anova(mod.2018.t.4.5a)
#2018.t6 --> only ran one trial, so no need to include as factor
#trial as a fixed factor
mod.2018.t.6<-lm(Egg.count ~ Treatment * avg.inhab, data=egg.t6)
hist(resid(mod.2018.t.6))
qqnorm(resid(mod.2018.t.6))
qqline(resid(mod.2018.t.6))
anova(mod.2018.t.6)
ancova(Egg.count ~ Treatment * avg.inhab, data=egg.t4.5) #interaction between inhab and trial
ancova(Egg.count ~ Treatment * avg.inhab, data=egg.t6) #interaction between inhab and trial
#2018.t6 --> only ran one trial, so no need to include as factor
#trial as a fixed factor
mod.2018.t.6<-lm(Egg.count ~ Treatment * avg.inhab, data=egg.t6)
anova(mod.2018.t.6)
