axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton ( '~CO[2]~ week^-2~s^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton ('~Reef^-1~ week^-2~s^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton ('~Reef ^-1~ week^-2~s^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton ('~Reef^ -1~ week^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton
('~Reef^ -1~ week^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton
('~Reef^ -1~ week^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton
('~Reef^ -1~ week^-1*')')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton '~Reef^ -1~ week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment, linetype=Treatment, col=Treatment)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
png("Output/2020.4.11.gobies.per.reef.9.5x5.5.300dpi.png", width = 9.5, height = 5.5, units = 'in', res = 300)
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x="Gobies per Reef",y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
dev.off()
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
repro$Treatment.ord<-ordered(repro$Treatment,levels=c("Low","Medium","High"))
png("Output/2020.4.11.gobies.per.reef.9.5x5.5.300dpi.png", width = 9.5, height = 5.5, units = 'in', res = 300)
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=18)) +
theme(legend.title =element_text(size=20))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
dev.off()
png("Output/2020.4.11.gobies.per.reef.9.5x5.5.300dpi.png", width = 9.5, height = 5.5, units = 'in', res = 300)
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=15)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
dev.off()
png("Output/2020.4.11.gobies.per.reef.9.5x5.5.300dpi.png", width = 9.5, height = 5.5, units = 'in', res = 300)
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=16)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
dev.off()
png("Output/2020.4.11.gobies.per.reef.9.5x5.5.300dpi.png", width = 9.5, height = 5.7, units = 'in', res = 300)
anc1<-ggplot(repro, aes(avg.inhab, egg.week, shape=Treatment.ord, linetype=Treatment.ord, col=Treatment.ord)) +
geom_smooth(method="lm", se=FALSE, show.legend = TRUE)  +
geom_point(size=3)+
theme_classic()+
labs(x=(bquote('Gobies '~Reef^ -1*'')),y=(bquote('Reproducton '~Reef^ -1~ Week^-1*'')))+
expand_limits(y=0)+
scale_color_manual(values=c("black", "#666666", "grey"))+
scale_linetype_manual(values=c("solid", "dashed", "twodash"))+
theme(axis.text.x=element_text(size=20, colour="black"),
axis.text.y=element_text(size=20, colour="black"),
axis.title=element_text(size=20))+
theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(margin = margin(t = 12, r = 0, b = 0, l = 0)),
axis.text.x = element_text(margin = margin(t = 10, r = 0, b = 0, l = 0))) +
theme(legend.text=element_text(size=16)) +
theme(legend.title =element_text(size=17))+
scale_x_continuous(breaks=c(10,12,14,16,18,20)) + scale_y_continuous(limits = c(0,12000))+
labs(color  = "Perceived Risk", linetype = "Perceived Risk", shape = "Perceived Risk")
anc1
dev.off()
rm(list=ls())
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/reproductive_output.R', echo=TRUE)
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/reproductive_output.R', echo=TRUE)
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/goby_reproduction.2020.4.9.csv")
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding egg/week variable to the dataset for comparisons among trials of differing length
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#making Year and Trial factors
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
#subsetting data from Trial 6 for comparison of caged vs. uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subset treatments, caged and uncaged only to test for cage effects
## Note that Treatment factor for trial 6 models should be replaced with "T6.comparison"
repro.t6<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
#same model, but with separate slopes for each trial ((avg.inhab|Treatment:Trial))
mer<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(avg.inhab|Treatment:Trial), REML=F, repro)
hist(resid(mer))
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
anova(me)
#same model, but with separate slopes for each trial ((avg.inhab|Treatment:Trial))
mer<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(avg.inhab|Treatment:Trial), REML=F, repro)
hist(resid(mer))
qqnorm(resid(mer))
qqline(resid(mer))
plot(mer)
summary(mer)
anova(mer)
anova(me)
anova(me,mer)
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/reproductive_output.R')
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
hist(resid(me))
qqnorm(resid(me))
qqline(resid(me))
plot(me)
summary(me)
# 1c. same analysis with log-likelihood estimates, but with sqrt.eggs as response####
## all I have to do is change the orignial model
mes<-lmer(sqrt.egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
hist(resid(mes))
qqnorm(resid(mes))
qqline(resid(mes))
plot(mes)
summary(mes)
#removing three-way interaction of random effect
mes2<-update(mes, .~. -(1|avg.inhab:Treatment:Trial))
summary(mes2)
anova(mes2)
anova(mes,mes2) #no difference in models when three-way interaction with random intercept is removed
mes3<-update(mes2, .~. -(1|Treatment:Trial))
summary(mes3)
anova(mes3)
anova(mes2,mes3) #no difference
mes4<-update(mes3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
## in fact, it may put more variance in the overall model, including variance for fixed effects
summary(mes4) # trial accounts for 4% of the residual variance
anova(mes4)
anova(mes3,mes4) # P = 1, which is different from the analyses for raw data
#trial effect
mes5<-update(mes2,.~. -(1|Trial))
summary(mes5)
anova(mes5)
anova(mes2,mes5) # no sig. effect of trial
source('C:/Users/George/Desktop/2018 summer/2018 Goby/Goby_reproduction_by_risk/2018.data.for.analyses.R/2018 egg counts/Scripts/reproductive_output.R')
library(lme4)
library(lmerTest)
library(dplyr)
library(ggplot2)
library(emmeans) #for generating least-squares adjusted means from models (will likely help when I have to
#importing dataset####
repro<-read.csv("Data/goby_reproduction.2020.4.9.csv")
#adding column for average number of inhabitants throughout the trial, rounded to nearest whole number of fish
repro$avg.inhab<-(ceiling((repro$Recollection+20)/2))
#adding egg/week variable to the dataset for comparisons among trials of differing length
repro<-repro %>%
mutate(egg.week = ifelse(Trial<4, Egg.count/1,
ifelse(Trial == 4| Trial == 5, (ceiling(Egg.count/4)),
ifelse(Trial == 6, (ceiling(Egg.count/2)), NA))))
#adding a column for year (as a proxy for tagging procedure), where trials 1-3 = 2017, and 4-6 = 2018
repro$Year <- ifelse(repro$Trial <=3, 2017, 2018)
#making Year and Trial factors
repro$Year<- as.factor(repro$Year)
repro$Trial<-as.factor(repro$Trial)
#sqrt-transforming egg counts to better satisfy assumptions
repro$sqrt.egg.week<-sqrt(repro$egg.week)
#subsetting data from Trial 6 for comparison of caged vs. uncaged treatments
#subset trial
repro.t6<-repro[repro$Trial==6,]
#subset treatments, caged and uncaged only to test for cage effects
## Note that Treatment factor for trial 6 models should be replaced with "T6.comparison"
repro.t6<-repro.t6[repro.t6$T6.comparison == "High" | repro.t6$T6.comparison == "Uncaged", ]
options(contrasts = c("contr.sum","contr.poly")) #this is important, run before ANOVA, will set SS to type III
# 1a. all trials, raw data for reproduction per week####
# full model
me<-lmer(egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
ranef(me)$Trial
ranef(me)
coef(me)$Trial
rand(me)
fix(me)
fixed(me)
anova(me)
me$coefficient
me$coeff
coef(me)
levels(repro$Treatment)
summary(me)
boxplot(egg.week~Treatment,repro)
#removing three-way interaction of random effect
me2<-update(me, .~. -(1|avg.inhab:Treatment:Trial))
me3<-update(me2, .~. -(1|Treatment:Trial))
me4<-update(me3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
#trial effect
me5<-update(me2,.~. -(1|Trial))
me6<-update(me4, .~. -(Treatment:Year:avg.inhab))
#now removing Year.fact:avg.inhab (the order of removal seems arbitrary, but that's the next one)
me7<-update(me6, .~. -(Year:avg.inhab))
me8<-update(me7, .~. -(Treatment:avg.inhab))
#LS-adjusted means from model
emmeans(me8, pairwise~Treatment) #warning message re: interactions, but I think it's okay
rand(me)
# 1c. same analysis with log-likelihood estimates, but with sqrt.eggs as response####
## all I have to do is change the orignial model
mes<-lmer(sqrt.egg.week ~ Treatment*Year*avg.inhab + (1|Trial) + (1|Treatment:Trial) +
(1|Trial:avg.inhab)+(1|avg.inhab:Treatment:Trial), REML=F, repro)
rand(mes)
anova(mes8)
#removing three-way interaction of random effect
mes2<-update(mes, .~. -(1|avg.inhab:Treatment:Trial))
mes3<-update(mes2, .~. -(1|Treatment:Trial))
mes4<-update(mes3, .~. -(1|Trial:avg.inhab)) #all interactions with covariate that were N.S. were removed, including random effects
#trial effect
mes5<-update(mes2,.~. -(1|Trial))
mes6<-update(mes4, .~. -(Treatment:Year:avg.inhab))
anova(mes6)
#now removing Year.fact:avg.inhab (the order of removal seems arbitrary, but that's the next one)
mes7<-update(mes6, .~. -(Year:avg.inhab))
anova(mes7)
mes8<-update(mes7, .~. -(Treatment:avg.inhab))
anova(mes8)
summary(mes8) # trial variance is still 6% of residual variance for random effects
anova(mes8)
mes13<-lm(sqrt.egg.week~T6.comparison*avg.inhab,data=repro.t6)
anova(mes13)
mes14<-lm(sqrt.egg.week~T6.comparison+avg.inhab,data=repro.t6)
anova(mes14)
boxplot(sqrt.egg.week~T6.comparison,data=repro.t6)# variances don't look too bad
# LS-means for treatment from model:
emmeans(mes14, pairwise~T6.comparison)
